(this.webpackJsonppathways=this.webpackJsonppathways||[]).push([[0],{102:function(e,t,n){e.exports={node:"Node_node__38uoJ",icon:"Node_icon__354W4",statusIcon:"Node_statusIcon__NkBGU",onPatientPath:"Node_onPatientPath__3LPjE",actionable:"Node_actionable__bHXKd",declined:"Node_declined__2Dd-4",notOnPatientPath:"Node_notOnPatientPath__24OpF",expandedNode:"Node_expandedNode__1ar-A",childOnPatientPath:"Node_childOnPatientPath__28UD6",childActionable:"Node_childActionable__SwUjD",childNotOnPatientPath:"Node_childNotOnPatientPath__2j4QB",childDeclined:"Node_childDeclined__2Gx9j"}},115:function(e,t,n){e.exports={infoTable:"ExpandedNode_infoTable__3v2tx",descTitle:"ExpandedNode_descTitle__15ki8",desc:"ExpandedNode_desc__3Xdkf",externalLink:"ExpandedNode_externalLink__1Mr1x",button:"ExpandedNode_button__Tvpk5",commentsForm:"ExpandedNode_commentsForm__3Q20Y",footer:"ExpandedNode_footer__FOCYI",comments:"ExpandedNode_comments__9q-JW"}},1181:function(e,t,n){},1184:function(e,t,n){e.exports=n.p+"static/media/camino-logo-dark.c8fc712a.png"},1187:function(e,t,n){e.exports={pathwayPopup:"PathwayPopup_pathwayPopup__2moYb"}},1196:function(e,t,n){e.exports={root:"Graph_root__1SJOc"}},1211:function(e,t,n){e.exports=n(1735)},135:function(e,t,n){e.exports={expanded:"styles_expanded__XNUv-",expandedNode:"styles_expandedNode__26Fy8",nodeTitle:"styles_nodeTitle__5mm8f",clickable:"styles_clickable__3HzZZ",iconAndLabel:"styles_iconAndLabel__2LOTu",statusIcon:"styles_statusIcon__2jDwI",button:"styles_button__1AUjr"}},137:function(e,t,n){e.exports={record:"PatientRecord_record__2CgGD",recordToggle:"PatientRecord_recordToggle__2Vhvd",sidebar:"PatientRecord_sidebar__1Box0",element:"PatientRecord_element__RKq2B",title:"PatientRecord_title__2U0uE",expand:"PatientRecord_expand__M9HFP",visualizerContainer:"PatientRecord_visualizerContainer__PamdD"}},138:function(e,t,n){e.exports={fieldContainer:"ReportSection_fieldContainer__3LwUq",field:"ReportSection_field__Cxwdy",sectionContainer:"ReportSection_sectionContainer__3gJ8s",sectionIconContainer:"ReportSection_sectionIconContainer__3pp4w",icon:"ReportSection_icon__1NGg-",notesField:"ReportSection_notesField__67Cly"}},147:function(e,t,n){"use strict";(function(e){var a=n(65),r=n(82),i=n(181),o=new(function(){function t(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Object(r.a)(this,t),this.config=e.CONFIG?Object(a.a)({},e.CONFIG,{},n):Object(a.a)({},n)}return Object(i.a)(t,[{key:"get",value:function(e,t){var n=e.split("."),a=this.config,r=null;for(var i in n){a=r=a[n[i]]}return r||t}},{key:"add",value:function(e){e&&(this.config=Object(a.a)({},this.config,{},e))}}]),t}());t.a=o}).call(this,n(83))},1497:function(e,t){},1499:function(e,t){},1522:function(e,t){},171:function(e,t,n){e.exports={missingDataPopup:"MissingDataPopup_missingDataPopup__A-EBJ",popupContent:"MissingDataPopup_popupContent__24BvC",popupTrigger:"MissingDataPopup_popupTrigger__11eAy",popupChoice:"MissingDataPopup_popupChoice__5oEld",selected:"MissingDataPopup_selected__20Or7",footer:"MissingDataPopup_footer__1wJXm",externalLink:"MissingDataPopup_externalLink__3oYt-"}},1735:function(e,t,n){"use strict";n.r(t);n(1212),n(1220);var a=n(0),r=n.n(a),i=n(44),o=n.n(i),c=n(1199),l=n(170),u=n(169),s=n(38),d=n(41),m=n(29),p=n(1767),v=n(1770),f=n(1763),h=n(65),y=n(1201),b={white:"#fff",black:"#222",blue:"#5d89a1",red:"#d95d77",gray:"#4a4a4a",grayMedium:"#bbbdc0",grayBlue:"#cbd5df",grayLighter:"#eaeef2",green:"#2fa874"},E={fontFamily:"'Open Sans', -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Oxygen', 'Ubuntu', 'Cantarell', 'Fira Sans', 'Droid Sans', 'Helvetica Neue', sans-serif"},g={MuiButton:{root:{borderRadius:0},label:{fontWeight:600},iconSizeMedium:{"& > *:first-child":{fontSize:14}},iconSizeSmall:{"& > *:first-child":{fontSize:14}}}},_=Object(y.a)({typography:Object(h.a)({},E),palette:{primary:{main:b.blue},secondary:{main:b.red},common:b,background:{default:b.grayLighter},text:{primary:b.gray,secondary:b.gray}},overrides:Object(h.a)({},g)}),w=Object(y.a)({typography:Object(h.a)({},E),palette:{primary:{main:b.blue},secondary:{main:b.red},common:b,background:{default:b.grayBlue},text:{primary:b.black,secondary:b.black}},overrides:Object(h.a)({},g)}),P=Object(a.createContext)((function(){})),C=function(e){var t=e.children,n=Object(a.useState)(_),i=Object(s.a)(n,2),o=i[0],c=i[1],l=Object(a.useCallback)((function(){c((function(e){return e===_?w:_}))}),[]);return r.a.createElement(f.a,{theme:o},r.a.createElement(P.Provider,{value:l},t))},j=n(1181),O=n.n(j),N=function(e){var t=Object(a.useState)(null),n=Object(s.a)(t,2),i=n[0],o=n[1],c=Object(a.useContext)(P),l=function(){o(null)};return r.a.createElement("header",{className:O.a.header},r.a.createElement("img",{src:e.logo,alt:"logo"}),r.a.createElement("button",{onClick:function(e){o(e.currentTarget)},"aria-controls":"options-menu","aria-haspopup":"true"},r.a.createElement(d.a,{icon:m.h})),r.a.createElement(p.a,{id:"options-menu",anchorEl:i,keepMounted:!0,open:Boolean(i),onClose:l},r.a.createElement(v.a,{onClick:function(){c(),l()}},"Toggle Theme")))},k=n(1765),x=n(40),R=Object(a.createContext)({patient:null,setPatient:function(){}}),S=function(e){var t=e.children,n=e.value;return null==n.patient?r.a.createElement("div",null,"Loading..."):r.a.createElement(R.Provider,{value:n},t)},D=function(){return Object(a.useContext)(R)},T=n(208),M=n.n(T),A=Object(k.a)((function(e){return{"patient-snapshot-list":{color:e.palette.text.primary}}}),{name:"PatientSnapshot"}),L=function(){var e=A(),t=D().patient,n=Object(a.useMemo)((function(){return function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=e.find((function(e){return"official"===e.use}))||e[0];return t?"".concat((t.given||[]).join(" ")," ").concat(t.family):"No name"}(t.name)}),[t]),i=Object(a.useMemo)((function(){return function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=e[0];return t?[t.city,t.state].filter((function(e){return!!e})).join(", "):"No Address"}(t.address)}),[t]),o=Object(a.useMemo)((function(){return function(e){if(!e)return 0;var t=new Date,n=new Date(e),a=t.getFullYear()-n.getFullYear(),r=t.getMonth()-n.getMonth();return(r<0||0===r&&t.getDate()<n.getDate())&&a--,a}(t.birthDate)}),[t]);return r.a.createElement("div",{className:M.a.patientSnapshot},r.a.createElement(d.a,{icon:m.y,className:M.a.patientSnapshot__photo}),r.a.createElement("div",{className:M.a.patientSnapshot__info},r.a.createElement("div",{className:M.a.patientName},n),r.a.createElement("ul",{className:Object(x.a)(M.a.patientSnapshot__list,e["patient-snapshot-list"])},r.a.createElement("li",null,"DOB: ",t.birthDate," (Age: ",o,")"),r.a.createElement("li",null,"Admin. Sex: ",t.gender),r.a.createElement("li",null,"Location: ",i))))},I=n(1200),q=n(417),B=n.n(q),z=Object(a.createContext)({evaluatedPathway:null,setEvaluatedPathway:function(){},updateEvaluatedPathways:function(){},assignPathway:function(){},unassignPathway:function(){}}),U=function(e){var t=e.children,n=e.pathwayCtx;return r.a.createElement(z.Provider,{value:n},t)},F=function(){return Object(a.useContext)(z)},H=Object(a.createContext)({user:"",setUser:function(){}}),G=function(e){var t=e.children,n=e.value;return r.a.createElement(H.Provider,{value:n},t)},V=Object(a.createContext)({note:null,setNote:function(){}}),W=function(e){var t,n=e.children,i=e.date,o=D().patient,c=Object(a.useContext)(H).user,l=(null===o||void 0===o?void 0:o.name)?$(o.name):"",u=Object(a.useState)({patient:l,date:i.toDateString(),physician:c,birthdate:(null===o||void 0===o?void 0:o.birthDate)||"",mcodeElements:{},pathway:null===(t=F().evaluatedPathway)||void 0===t?void 0:t.pathway.name,status:"Pending"}),d=Object(s.a)(u,2),m=d[0],p=d[1];return r.a.createElement(V.Provider,{value:{note:m,setNote:p}},n)},J=function(){return Object(a.useContext)(V)},Q=function(e){var t="";return Object.keys(e.mcodeElements).forEach((function(n){t+="".concat(n,": ").concat(e.mcodeElements[n],"\n")})),"Date: ".concat(e.date,"\n\nPatient: ").concat(e.patient,"\n\nBirthdate: ").concat(e.birthdate,"\n\nPhysician: ").concat(e.physician,"\n\n").concat(t,"\nPathway: ").concat(e.pathway,"\n\nNode: ").concat(e.node,"\n\nStatus: ").concat(e.status,"\n\nTreatment: ").concat(e.treatment,"\n\nNotes: ").concat(e.notes)},X=n(1183),Y=n(1769),K=n(299),Z=n.n(K);function $(e){var t,n,a,r,i,o,c,l="";Array.isArray(e)&&(l=[null===(t=e[0])||void 0===t?void 0:null===(n=t.prefix)||void 0===n?void 0:n.join(" "),null===(a=e[0])||void 0===a?void 0:null===(r=a.given)||void 0===r?void 0:r.join(" "),null===(i=e[0])||void 0===i?void 0:i.family,null===(o=e[0])||void 0===o?void 0:null===(c=o.suffix)||void 0===c?void 0:c.join(" ")].join(" "));return l}function ee(e,t){return{resourceType:"DocumentReference",id:Object(Y.a)(),meta:{lastUpdated:ae()},status:"current",subject:{reference:"Patient/".concat(t.id)},content:[{attachment:{data:btoa(e),contentType:"text/plain"}}],type:{coding:[{system:"http://loinc.org",code:"34108-1",display:"Outpatient Note"}]},indexed:""}}function te(e,t,n){var a=ee(e,n);return Object(h.a)({},a,{identifier:[{system:"pathways.documentreference",value:btoa(t)}]})}function ne(e,t,n,a,r){e.status=n,e.notes=a,r&&(e.treatment=r.action.description,e.node=r.label);var i=["","",""];return t.forEach((function(t){var n;if((null===(n=t.meta)||void 0===n?void 0:n.profile)&&t.meta.profile.length){var a=["TNMClinicalPrimaryTumorCategory","TNMClinicalRegionalNodesCategory","TNMClinicalDistantMetastasesCategory"],r=t.meta.profile[0];if("Observation"===t.resourceType)if(r.includes("TumorMarkerTest")&&"Observation"===t.resourceType){var o,c=t,l=null===(o=c.valueCodeableConcept)||void 0===o?void 0:o.text,u=c.code.text;l&&u&&(e.mcodeElements[u]=l)}else if(a.some((function(e){return r.includes(e)}))){var s=a.findIndex((function(e){return r.includes(e)}));if(s>-1){var d,m=null===(d=t.valueCodeableConcept)||void 0===d?void 0:d.text;m&&(i[s]=m)}}}})),e.mcodeElements["Clinical TNM"]=i.join(" "),Q(e)}function ae(){var e=new Date;return e.getFullYear()+"-"+re(e.getMonth())+"-"+re(e.getDay())+"T"+re(e.getUTCHours())+":"+re(e.getUTCMinutes())+":"+re(e.getUTCSeconds())+"."+e.getUTCMilliseconds()+"+00:00"}function re(e){return e<10?"0"+e:e.toString()}function ie(e,t){return!!t&&e.filter((function(e){return"CarePlan"===e.resourceType})).filter((function(e){return"active"===e.status})).map((function(e){return e.title})).includes(t.name)}function oe(e){var t,n,a,r=[null===(t=e["Tumor Category"])||void 0===t?void 0:t.split(" ")[0],null===(n=e["Node Category"])||void 0===n?void 0:n.split(" ")[0],null===(a=e["Metastases Category"])||void 0===a?void 0:a.split(" ")[0]].join(" ");return"   "===r?"Unknown":r}function ce(e,t){var n=t.find((function(t){if("DocumentReference"!==t.resourceType)return!1;var n=t;if(void 0===n.identifier)return!1;var a=!0,r=!1,i=void 0;try{for(var o,c=n.identifier[Symbol.iterator]();!(a=(o=c.next()).done);a=!0){var l=o.value;if("pathways.documentreference"===l.system&&l.value===btoa(e))return!0}}catch(u){r=!0,i=u}finally{try{a||null==c.return||c.return()}finally{if(r)throw i}}return!1}));return n||null}var le=Object(a.createContext)({patientRecords:[],setPatientRecords:function(){},evaluatePath:!0,setEvaluatePath:function(){},mcodeRecords:{},setMcodeRecords:function(){}}),ue=function(e){var t=e.children,n=e.value;return r.a.createElement(le.Provider,{value:n},t)},se=function(){return Object(a.useContext)(le)},de=n(1771),me=function(e){var t=e.options,n=e.label,i=e.id,o=e.visible,c=e.onChange,l=e.selectedValue,u=e.setSelectPathway,s=se().patientRecords,p=F(),v=p.evaluatedPathway,f=p.assignPathway,h=p.unassignPathway,y=Object(a.useCallback)((function(e){c&&c(null==e?null:e)}),[c]),b=ie(s,null===v||void 0===v?void 0:v.pathway);return o?r.a.createElement("div",{className:B.a.dropdown},r.a.createElement("div",null,r.a.createElement("label",{htmlFor:i},n),r.a.createElement(de.a,{onClick:function(){u(!0)},variant:"contained",color:"primary",startIcon:r.a.createElement(d.a,{icon:m.u})},"Explore"),r.a.createElement(de.a,{onClick:function(){(null===v||void 0===v?void 0:v.pathway)?b?h(v.pathway.name):f(v.pathway.name):alert("Unable to perform action. No pathway is selected.")},variant:"contained",color:b?"secondary":"primary",startIcon:r.a.createElement(d.a,{icon:b?m.w:m.d})},b?"Unassign":"Assign")),r.a.createElement(I.a,{classNamePrefix:"DropDown",inputId:i,value:l,onChange:y,options:t,"aria-label":n,formatOptionLabel:function(e){return r.a.createElement(r.a.Fragment,null,e.label,ie(s,e.value.pathway)&&r.a.createElement(d.a,{icon:m.d,className:B.a.check}))}})):r.a.createElement("div",null)},pe=n(237),ve=n.n(pe),fe=Object(k.a)((function(e){return{navigation:{backgroundColor:e.palette.background.default,color:e.palette.text.primary}}}),{name:"Navigation"}),he=function(e){var t,n=e.evaluatedPathways,a=e.selectPathway,i=e.setSelectPathway,o=e.onBack,c=fe(),l=F(),u=null===(t=l.evaluatedPathway)||void 0===t?void 0:t.pathway,s=void 0===u?null:{label:u.name,value:l.evaluatedPathway},p=n.map((function(e){return{label:e.pathway.name,value:e}}));return r.a.createElement("nav",{className:Object(x.a)(ve.a.navigation,c.navigation)},r.a.createElement("div",{className:ve.a.navigation__leftPanel},o&&r.a.createElement(d.a,{icon:m.f,className:ve.a.navigation__back,onClick:o}),r.a.createElement(L,null)),r.a.createElement("div",{className:ve.a.navigation__rightPanel},r.a.createElement(me,{label:"Pathway:",id:"patient-view",visible:!a,options:p,selectedValue:s,setSelectPathway:i,onChange:function(e){null!==e&&"value"in e&&l.setEvaluatedPathway(e.value)}})))},ye=n(1184),be=n.n(ye),Ee=["ReferralRequest:patient","DocumentManifest:patient","Goal:patient","Consent:patient","DocumentReference:patient","ImagingManifest:patient","RiskAssessment:patient","CareTeam:patient","ImagingStudy:patient","FamilyMemberHistory:patient","Encounter:patient","DeviceRequest:patient","AllergyIntolerance:patient","CarePlan:patient","EpisodeOfCare:patient","Procedure:patient","List:patient","Immunization:patient","VisionPrescription:patient","ProcedureRequest:patient","Flag:patient","Observation:patient","DiagnosticReport:patient","NutritionOrder:patient","Condition:patient","Composition:patient","DetectedIssue:patient","SupplyDelivery:patient","ClinicalImpression:patient","DeviceUseStatement:patient","Task:subject","Task:requester","Task:patient","Task:owner","Task:focus","Task:based-on","SupplyRequest:requester","Specimen:subject","Specimen:patient","ServiceDefinition:successor","ServiceDefinition:predecessor","ServiceDefinition:depends-on","ServiceDefinition:derived-from","ServiceDefinition:composed-of","Sequence:patient","Schedule:actor","RiskAssessment:subject","ResearchSubject:patient","ResearchSubject:individual","RequestGroup:subject","RequestGroup:participant","RequestGroup:patient","RequestGroup:definition","RelatedPerson:patient","ReferralRequest:subject","ReferralRequest:requester","QuestionnaireResponse:subject","QuestionnaireResponse:source","QuestionnaireResponse:patient","QuestionnaireResponse:author","Provenance:target","Provenance:entity-ref","Provenance:patient","Provenance:agent","ProcessResponse:request","ProcedureRequest:subject","ProcedureRequest:replaces","ProcedureRequest:performer","ProcedureRequest:based-on","Procedure:subject","Procedure:performer","PlanDefinition:successor","PlanDefinition:predecessor","PlanDefinition:derived-from","PlanDefinition:depends-on","PlanDefinition:composed-of","Person:patient","Person:link","PaymentNotice:response","PaymentNotice:request","Patient:link","Observation:subject","Observation:performer","MessageHeader:focus","MedicationStatement:source","MedicationStatement:subject","MedicationRequest:subject","MedicationRequest:requester","MedicationDispense:subject","MedicationDispense:receiver","MedicationDispense:performer","MedicationAdministration:subject","MedicationRequest:patient","MedicationAdministration:patient","MedicationStatement:patient","MedicationDispense:patient","MedicationAdministration:performer","Media:subject","Media:patient","MeasureReport:patient","Measure:successor","Measure:predecessor","Measure:derived-from","Measure:depends-on","Measure:composed-of","List:subject","List:item","List:source","Library:successor","Library:predecessor","Library:derived-from","Library:composed-of","Library:depends-on","ImplementationGuide:resource","ImmunizationRecommendation:patient","ImagingManifest:author","GuidanceResponse:subject","GuidanceResponse:patient","Group:member","Goal:subject","Flag:subject","Flag:author","ExplanationOfBenefit:patient","ExplanationOfBenefit:payee","EnrollmentRequest:subject","EnrollmentRequest:patient","Encounter:subject","EligibilityRequest:patient","DocumentReference:subject","DocumentReference:related-ref","DocumentReference:author","DocumentManifest:subject","DocumentManifest:related-ref","DocumentManifest:content-ref","DocumentManifest:recipient","DiagnosticReport:subject","DocumentManifest:author","DeviceUseStatement:subject","DeviceRequest:subject","DeviceRequest:priorrequest","DeviceRequest:performer","DeviceRequest:based-on","Device:patient","DetectedIssue:implicated","Coverage:subscriber","Coverage:policy-holder","Coverage:payor","Contract:term-topic","Coverage:beneficiary","Contract:subject","Contract:signer","Contract:patient","Contract:agent","Consent:data","Consent:consentor","Consent:actor","Condition:subject","Condition:evidence-detail","Condition:asserter","Composition:subject","Composition:entry","Composition:author","Composition:attester","CommunicationRequest:subject","CommunicationRequest:sender","CommunicationRequest:requester","CommunicationRequest:recipient","CommunicationRequest:patient","CommunicationRequest:based-on","Communication:subject","Communication:recipient","Communication:sender","Communication:patient","Communication:part-of","Communication:based-on","ClinicalImpression:subject","ClaimResponse:patient","Claim:payee","Claim:patient","ChargeItem:subject","ChargeItem:patient","ChargeItem:participant-actor","ChargeItem:enterer","CareTeam:subject","CareTeam:participant","CarePlan:performer","CarePlan:subject","BodySite:patient","Basic:subject","Basic:patient","Basic:author","AuditEvent:patient","AuditEvent:entity","AuditEvent:agent","AppointmentResponse:patient","AppointmentResponse:actor","Appointment:patient","Appointment:actor","AllergyIntolerance:recorder","AllergyIntolerance:asserter","AdverseEvent:subject","AdverseEvent:recorder","ActivityDefinition:successor","ActivityDefinition:predecessor","ActivityDefinition:depends-on","ActivityDefinition:derived-from","ActivityDefinition:composed-of","Account:subject","Account:patient"],ge=n(1185),_e=n(147),we=_e.a.get("mapper"),Pe=ge.mappers[we],Ce=Pe?new Pe:null,je=function(e){return Ce&&e&&(e=Ce.execute(e)),e};function Oe(e,t){t.push("Patient:_id");var n=[];return t.forEach((function(t){t=t.split(":");var a=e.request("".concat(t[0],"?").concat(t[1],"=").concat(e.patient.id),{flat:!0,pageLimit:0}).then((function(e){if(e.length>0)return e})).catch((function(e){console.log("failed to fetch ".concat(t)),console.error(e)}));n.push(a)})),Promise.all(n).then((function(e){return e.filter((function(e){return e})).flat()}))}function Ne(e,t,n){var a=t.join("&_revinclude=");return e.request("/Patient?_id=".concat(e.patient.id,"&_revinclude=").concat(a),{flat:!0}).then((function(e){return e})).catch((function(a){console.log("Reverse Include query failed, manually fetching resources instead."),console.error(a),n(e,t)}))}var ke=Object(a.createContext)({patient:{}}),xe=function(e){var t=e.client,n=e.children;return r.a.createElement(ke.Provider,{value:t},n)},Re=function(){return Object(a.useContext)(ke)},Se=n(126),De=n(137),Te=n.n(De);function Me(e){return new Promise((function(t,n){var a={};e.library.slice(1).forEach((function(e){var t=function(e){var t=e.split("\n").find((function(e){return e.trim().startsWith("library ")}));if(!t)throw new Error("cql does not contain a library name: ".concat(e));var n=t.trim(),a=n.indexOf(" "),r=n.indexOf(" ",a+1),i=n.substring(a+1,r);i.startsWith('"')&&(i=i.slice(1,-1));return i}(e);a[t]=e})),t({main:e.library[0],libraries:a})}))}var Ae=/.*;boundary=(Boundary.*);?.*/,Le=/Content-Disposition: form-data; name="([^"]+)"/,Ie=/(\{[^]*\})/,qe=_e.a.get("cqlToElmWebserviceUrl");var Be=n(206),ze=n(1186);function Ue(e,t,n){var a;a=n?new Be.Library(t,new Be.Repository(n)):new Be.Library(t);var r=new Be.Executor(a),i=new ze.PatientSource.FHIRv401(e);return i.loadBundles(e),r.exec(i)}function Fe(e,t,n){var a=[],r=["Start"],i={};do{a=r,r=[];var o=!0,c=!1,l=void 0;try{for(var u,d=a[Symbol.iterator]();!(o=(u=d.next()).done);o=!0){var m=u.value,p=e.nodes[m],v=He(p,t,n),f=Object(s.a)(v,2),y=f[0],b=f[1];if("completed"===y||b){if(i[m]={node:m,onPath:!0},b){var E,g,_=i[m];_.resourceType=null!==(E=b.resourceType)&&void 0!==E?E:"",_.id=null!==(g=b.id)&&void 0!==g?g:"",_.status="status"in b?b.status:"unknown",_.resource=Ve(_,n)}"completed"===y?r=Ge(p,t,n,b):(a=[m],r=[]);break}}}catch(w){c=!0,l=w}finally{try{o||null==d.return||d.return()}finally{if(c)throw l}}}while(0!==r.length);return function(e,t,n,a){for(var r=Object.values(a).filter((function(e){return e.onPath})).map((function(e){return e.node})),i=0,o=Object.entries(e.nodes);i<o.length;i++){var c=o[i],l=Object(s.a)(c,2),u=l[0],d=l[1];if(!r.includes(u))if("action"in d){if(t[u]&&t[u].length){var m=t[u][0];m.node=u,m.onPath=!1,m.resource=Ve(m,n),a[u]=Object(h.a)({},m)}}else{var p=!0,v=!1,f=void 0;try{for(var y,b=d.transitions[Symbol.iterator]();!(p=(y=b.next()).done);p=!0){var E=y.value;if(E.condition){var g=ce(E.condition.description,n);if(g){var _={resourceType:"DocumentReference",status:g.status,id:g.id,node:u,onPath:!1,resource:g};a[u]=Object(h.a)({},_)}}}}catch(w){v=!0,f=w}finally{try{p||null==b.return||b.return()}finally{if(v)throw f}}}}}(e,t,n,i),{patientId:t.Patient.id.value,currentNodes:a,documentation:i}}function He(e,t,n){var a="",r=null;switch(e.type){case"start":a="completed";break;case"action":var i=t[e.key],o=null;Array.isArray(i)?i.length>0&&(o=i[0]):i&&(o=i),o?a="status"in(r=o)?r.status:"unknown":r=ce(e.label,n),"completed"!==a&&function(e,t){return t.some((function(t){if("DocumentReference"!==t.resourceType)return!1;var n=t.content[0].attachment.data;return!!n&&atob(n)==="".concat(e.label," - Advance")}))}(e,n)&&(a="completed");break;case"branch":if(e.transitions.some((function(e){var n,a;return(null===e||void 0===e?void 0:null===(n=e.condition)||void 0===n?void 0:n.description)&&t[null===e||void 0===e?void 0:null===(a=e.condition)||void 0===a?void 0:a.description]})))a="completed";else{var c=e.transitions.map((function(e){return(null===e||void 0===e?void 0:e.condition)&&ce(e.condition.description,n)})).find((function(e){return e}));c&&(a="completed",r=c)}break;default:a="not-started"}return[a,r]}function Ge(e,t,n,a){var r=[];switch(e.type){case"start":case"action":r=e.transitions.map((function(e){return e.transition}));break;case"branch":var i=void 0;if("DocumentReference"===(null===a||void 0===a?void 0:a.resourceType)){var o,c=a;(null===c||void 0===c?void 0:c.identifier)&&(null===(o=c.identifier[0])||void 0===o?void 0:o.value)&&(i=atob(c.identifier[0].value))}r=e.transitions.filter((function(e){var n;return(null===e||void 0===e?void 0:null===(n=e.condition)||void 0===n?void 0:n.description)&&(t[e.condition.description]||e.condition.description===i)})).map((function(e){return e.transition}));break;default:r=[]}return r}function Ve(e,t){var n=void 0;return"resourceType"in e&&t&&(n=t.find((function(t){return t.resourceType===e.resourceType&&t.id===e.id}))),n}function We(e,t){var n;return((null===(n=t.elm)||void 0===n?void 0:n.preconditions)?Qe(e,t.elm.preconditions):Me(t).then((function(t){return Je(e,t)}))).then((function(e){return function(e,t){var n=[],a=0;return e.preconditions.forEach((function(e){var r=t[e.elementName];Array.isArray(r)&&(r=r[0]);var i="unknown",o=!1;r&&(i=r.value,o=r.match),o&&(a+=1);var c={elementName:e.elementName,expected:e.expected,actual:i,match:o};n.push(c)})),{pathwayName:e.name,matches:a,preconditionResultItems:n}}(t,e)}))}function Je(e,t){return(Object.keys(t.libraries).length>0?function(e){var t=new FormData;return Object.keys(e.libraries).forEach((function(n,a){t.append("".concat(n),e.libraries[n])})),t.append("main",e.main),fetch(qe,{method:"POST",body:t}).then((function(e){var t=e.headers.get("content-type"),n="";if(t){var a=Ae.exec(t);n=a?"--".concat(a[1]):""}var r={main:{},libraries:{}};return e.text().then((function(e){return e.split(n).reduce((function(e,t,n){var a=Ie.exec(t);if(a){var r=Le.exec(t);r&&"main"===r[1]?e[r[1]]=JSON.parse(a[1]):r&&(e.libraries[r[1]]=JSON.parse(a[1]))}return e}),r)}))}))}(t):function(e){return fetch(qe,{method:"POST",headers:{"Content-Type":"application/cql",Accept:"application/elm+json"},body:e}).then((function(e){return e.json()}))}(t.main)).then((function(t){return Qe(e,t)}))}function Qe(e,t){return new Promise((function(n,a){var r;r="main"in t?Ue(e,t.main,t.libraries):Ue(e,t);var i=Object.keys(r.patientResults);n(r.patientResults[i[0]])}))}var Xe=["Pathway","Mcode","Patient","Condition","Observation","DiagnosticReport","MedicationRequest","AllergyIntolerance","CarePlan","Procedure","Encounter","Immunization"],Ye=function(e,t){var n;return null!==(n=t.get(e))&&void 0!==n?n:[]},Ke=function(e){var t=e.recordSection,n=e.resources,i=Object(a.useState)(!1),o=Object(s.a)(i,2),c=o[0],l=o[1],u=c?m.g:m.e,p=["Patient","Pathway","Mcode"].includes(t)?"":"(".concat(n.length,")");return r.a.createElement("div",{className:Te.a.element},r.a.createElement("div",{className:Te.a.title,onClick:function(){return l(!c)}},r.a.createElement("div",null,t," ",p),r.a.createElement("div",{className:Te.a.expand},r.a.createElement(d.a,{icon:u}))),c&&r.a.createElement("div",{className:Te.a.visualizerContainer},r.a.createElement(Ze,{recordSection:t,resourcesByType:n})))},Ze=function(e){var t=e.recordSection,n=e.resourcesByType,a=D().patient;return"Pathway"===t?r.a.createElement($e,null):"Mcode"===t?r.a.createElement(et,null):"Patient"===t?r.a.createElement(Se.h,{patient:a}):"Condition"===t?r.a.createElement(Se.c,{rows:n}):"Observation"===t?r.a.createElement(Se.g,{rows:n}):"DiagnosticReport"===t?r.a.createElement(Se.j,{rows:n}):"MedicationRequest"===t?r.a.createElement(Se.f,{rows:n}):"AllergyIntolerance"===t?r.a.createElement(Se.a,{rows:n}):"CarePlan"===t?r.a.createElement(Se.b,{rows:n}):"Procedure"===t?r.a.createElement(Se.i,{rows:n}):"Encounter"===t?r.a.createElement(Se.d,{rows:n}):"Immunization"===t?r.a.createElement(Se.e,{rows:n}):r.a.createElement("div",null,"Unsupported Resource")},$e=function(){var e=se().patientRecords,t=F().evaluatedPathway,n=Object(a.useState)(null),i=Object(s.a)(n,2),o=i[0],c=i[1];return Object(a.useEffect)((function(){var n={resourceType:"Bundle",type:"searchset",entry:e.map((function(e){return{resource:e}}))};t&&We(n,t.pathway).then((function(e){return c(e)}))}),[t,e]),r.a.createElement("table",null,r.a.createElement("tbody",null,null===o||void 0===o?void 0:o.preconditionResultItems.map((function(e){return r.a.createElement("tr",{key:e.elementName},r.a.createElement("td",null,e.elementName),r.a.createElement("td",null,e.actual))}))))},et=function(){var e=se().mcodeRecords,t=[];for(var n in e)t.push(n);return r.a.createElement("table",null,r.a.createElement("tbody",null,t.map((function(t){return r.a.createElement("tr",{key:t},r.a.createElement("td",null,t),r.a.createElement("td",null,e[t]?e[t]:"-"))}))))},tt=function(e){var t=e.headerElement,n=se().patientRecords,i=Object(a.useRef)(null),o=Object(a.useState)(!1),c=Object(s.a)(o,2),l=c[0],u=c[1],p=function(e){var t=new Map;return e.forEach((function(e){var n,a=null!==(n=e.resourceType)&&void 0!==n?n:"";if(Xe.includes(a)){var r=t.get(a);r?r.push(e):t.set(a,[e])}})),t}(n),v=function(){u(!l)};return Object(a.useEffect)((function(){(null===i||void 0===i?void 0:i.current)&&(null===t||void 0===t?void 0:t.current)&&(i.current.style.height=window.innerHeight-t.current.clientHeight+"px")}),[l,t]),l?r.a.createElement("div",{className:Te.a.record,ref:i},r.a.createElement("div",{className:Te.a.sidebar},Xe.map((function(e){return r.a.createElement(Ke,{recordSection:e,resources:Ye(e,p),key:e})}))),r.a.createElement("div",{className:Te.a.recordToggle,onClick:v},r.a.createElement(d.a,{icon:m.f}))):r.a.createElement("div",{className:Te.a.record},r.a.createElement("div",{className:Te.a.recordToggle,onClick:v},r.a.createElement(d.a,{icon:m.n})))},nt=n(294),at=n(418),rt=n.n(at),it=_e.a.get("graphLayoutProvider","dagre");function ot(e,t){return"dagre"===it?function(e,t){var n=Object.keys(e.nodes),a=new rt.a.graphlib.Graph;a.setGraph({}),a.setDefaultEdgeLabel((function(){return{}})),n.forEach((function(n){var r=e.nodes[n],i=t[n];i?a.setNode(n,{label:r.label,width:i.width,height:i.height}):a.setNode(n,{label:r.label,width:10*r.label.length,height:50}),r.transitions.forEach((function(e){var t=e.condition?{label:e.condition.description,width:25,height:20}:{};a.setEdge(n,e.transition,t)}))})),rt.a.layout(a);for(var r={},i=a.node("Start").x,o=0,c=n;o<c.length;o++){var l=c[o],u=a.node(l);r[l]={x:u.x-i-u.width/2,y:u.y-u.height/2}}var s={};return a.edges().forEach((function(e){var t=a.edge(e),n="".concat(e.v,", ").concat(e.w),r=t.label?{text:t.label,x:t.x-i,y:t.y}:null;s[n]={label:r,start:e.v,end:e.w,points:t.points.map((function(e){return{x:e.x-i,y:e.y}}))}})),{nodeCoordinates:r,edges:s}}(e,t):function(e){var t="Start",n=function(e){var n,a={};for(n in e.nodes)a[n]={label:n,rank:NaN,horizontalPosition:NaN,children:[],parents:[],canMove:!0};return Object.keys(e.nodes).forEach((function(t){e.nodes[t].transitions.forEach((function(e){a[t].children.includes(e.transition)||a[t].children.push(e.transition),a[e.transition].parents.includes(t)||a[e.transition].parents.push(t)}))})),a[t].rank=0,a}(e),a=[[t]],r=110,i=100,o=0;do{var c=!0,l=!1,u=void 0;try{for(var s,d=a[o][Symbol.iterator]();!(c=(s=d.next()).done);c=!0){var m=s.value;y(n[m],o+1)}}catch(E){l=!0,u=E}finally{try{c||null==d.return||d.return()}finally{if(l)throw u}}o++}while(a.length!==o);for(p(n[t],-50),o=1;o<a.length;o++)v(o);return{nodeCoordinates:function(){var e={};for(var t in n){var a=n[t];e[t]={x:a.horizontalPosition,y:a.rank*i}}return e}(),edges:{}};function p(e,t){if(isNaN(e.horizontalPosition)||e.canMove){e.horizontalPosition=t;for(var n=1;f(e);){var a=n%2===0?-1:1;e.horizontalPosition=t+a*Math.ceil(n/2)*r,n+=1}}}function v(e){var t=!0,i=!1,o=void 0;try{for(var c,l=function(){var e=c.value,t=n[e];if(!isNaN(t.horizontalPosition))return"continue";var a=t.parents.filter((function(e){return n[e].rank<t.rank}));if(1===a.length){var i=t.parents[0],o=n[i];if(o.children.length%2===1)p(n[o.children[Math.floor(o.children.length/2)]],o.horizontalPosition);!function(e){var t=e.children.filter((function(e){return isNaN(n[e].horizontalPosition)||n[e].canMove}));if(0!==t.length)if(1!==t.length){t.length%2===1&&t.splice(Math.ceil(t.length/2),1);for(var a=0;a<t.length/2;a++){var i=n[t[t.length/2-a-1]];p(i,e.horizontalPosition-(a+1)*r),i.canMove=!1,p(i=n[t[t.length/2+a]],e.horizontalPosition+(a+1)*r),i.canMove=!1}}else p(n[t[0]],e.horizontalPosition)}(o)}else{var l=a.map((function(e){return n[e].horizontalPosition})).reduce((function(e,t){return e+t}),0);p(t,l/a.length)}},u=a[e][Symbol.iterator]();!(t=(c=u.next()).done);t=!0)l()}catch(E){i=!0,o=E}finally{try{t||null==u.return||u.return()}finally{if(i)throw o}}}function f(e){var t=a[e.rank].map((function(e){return n[e]})),r=!0,i=!1,o=void 0;try{for(var c,l=t[Symbol.iterator]();!(r=(c=l.next()).done);r=!0){if(h(e,c.value))return!0}}catch(E){i=!0,o=E}finally{try{r||null==l.return||l.return()}finally{if(i)throw o}}return!1}function h(e,t){return!function(e,t){return e.label===t.label}(e,t)&&(!isNaN(e.rank)&&!isNaN(e.horizontalPosition)&&!isNaN(t.rank)&&!isNaN(t.horizontalPosition)&&e.rank===t.rank&&e.horizontalPosition===t.horizontalPosition)}function y(e,t){e.children.forEach((function(r){var i=n[r];i.rank<e.rank?(a[i.rank].splice(a[i.rank].indexOf(r),1),b(r,t),y(i,t+1)):isNaN(i.rank)&&b(r,t)}))}function b(e,t){try{a[t].push(e)}catch(E){a[t]=[e]}finally{n[e].rank=t}}}(e)}var ct=n(102),lt=n.n(ct),ut=n(135),st=n.n(ut),dt=n(171),mt=n.n(dt),pt=n(1766),vt=n(1187),ft=n.n(vt),ht=function(e){var t=e.Content,n=e.Trigger,a=e.popupPosition,i=e.open,o=e.setOpen,c=e.className;return r.a.createElement(pt.a,{content:t,position:a||"bottom right",className:"".concat(ft.a.pathwayPopup," ").concat(c),on:"click",open:i,onOpen:function(){o&&o(!0)},onClose:function(){o&&o(!1)},pinned:!0,trigger:n})},yt=n(184),bt=n.n(yt),Et=function(e){var t=e.type,n=e.onClick;return r.a.createElement(de.a,{onClick:n,variant:"decline"===t?"text":"contained",color:"decline"===t?"secondary":"primary"},t[0].toUpperCase()+t.slice(1))},gt=function(e){var t=e.type,n=e.onClick;return r.a.createElement("div",{className:"".concat("accept"===t?bt.a.accept:bt.a.decline," ").concat(bt.a.smallActionButton),onClick:n,"data-testid":t},r.a.createElement(d.a,{icon:"accept"===t?m.c:m.v}))},_t=function(e){var t=e.type,n=e.onClick;return r.a.createElement("div",{className:"".concat("accept"===t?bt.a.accept:bt.a.decline," ").concat(bt.a.mediumActionButton),onClick:n,"data-testid":t},r.a.createElement(d.a,{icon:"accept"===t?m.c:m.v}),{accept:"Submit",decline:"Cancel"}[t])},wt=function(e){var t=e.type,n=e.size,a=e.onClick;switch(n){case"small":return r.a.createElement(gt,{type:t,onClick:a});case"large":return r.a.createElement(Et,{type:t,onClick:a});case"medium":return r.a.createElement(_t,{type:t,onClick:a})}},Pt=function(e){var t=e.values,n=e.setOpen,i=D().patient,o=Re(),c=se(),l=c.patientRecords,d=c.setPatientRecords,m=Object(a.useState)(!1),p=Object(s.a)(m,2),v=p[0],f=p[1],h=Object(a.useState)(""),y=Object(s.a)(h,2),b=y[0],E=y[1],g=J().note;return r.a.createElement("div",null,r.a.createElement("div",{className:mt.a.popupContent},"Select Value:",r.a.createElement("div",null,t.map((function(e){return r.a.createElement("div",{key:e,className:mt.a.popupChoice+" "+(b===e?mt.a.selected:""),onClick:function(){v&&b===e?(f(!1),E("")):(f(!0),E(e))}},e)})))),r.a.createElement("div",{className:mt.a.footer},r.a.createElement(wt,{size:"small",type:"decline",onClick:function(){return n(!1)}}),v&&r.a.createElement(wt,{size:"small",type:"accept",onClick:function(){if(n(!1),g){var e,t=te(ne(g,l,"completed",b),b,i);d([].concat(Object(u.a)(l),[t])),null===o||void 0===o||null===(e=o.create)||void 0===e||e.call(o,t)}}})))},Ct=function(e){var t=e.values,n=Object(a.useState)(!1),i=Object(s.a)(n,2),o=i[0],c=i[1];return r.a.createElement(ht,{Content:r.a.createElement(Pt,{values:t,setOpen:c}),className:mt.a.missingDataPopup,Trigger:r.a.createElement("div",{className:mt.a.popupTrigger},"missing data",r.a.createElement(d.a,{icon:m.i,className:mt.a.externalLink})),open:o,setOpen:c})},jt=n(115),Ot=n.n(jt),Nt=n(138),kt=n.n(Nt),xt=function(e){var t=e.sectionTitle,n=e.value;return r.a.createElement("div",{className:kt.a.field},r.a.createElement("b",null,t,": "),r.a.createElement("span",null,n))},Rt=function(e){var t=e.icon,n=e.notes;return r.a.createElement("div",{className:kt.a.sectionContainer},r.a.createElement("div",{className:kt.a.sectionIconContainer},r.a.createElement(d.a,{icon:t,className:kt.a.icon})),r.a.createElement("div",{className:kt.a.notesField},r.a.createElement("b",null,"Physician Notes: "),r.a.createElement("div",null,n)))},St=function(e){var t=e.icon,n=e.fields;return r.a.createElement("div",{className:kt.a.sectionContainer},r.a.createElement("div",{className:kt.a.sectionIconContainer},r.a.createElement(d.a,{icon:t,className:kt.a.icon})),r.a.createElement("div",{className:kt.a.fieldContainer},n.filter((function(e){return e.name})).map((function(e){return r.a.createElement(xt,{sectionTitle:e.name,value:e.value,key:Z.a.generate()})}))))},Dt=n(239),Tt=n.n(Dt),Mt=function(e){var t,n,a,i,o,c=e.onConfirm,l=e.onDecline,u=J().note,s=se().mcodeRecords,d=[{name:"Date",value:null===u||void 0===u?void 0:u.date},{name:"Patient",value:null===u||void 0===u?void 0:u.patient},{name:"Date of Birth",value:null===u||void 0===u?void 0:u.birthdate},{name:"Physician",value:null===u||void 0===u?void 0:u.physician}],p=[{name:"Primary Cancer",value:null!==(t=s["Primary Cancer"])&&void 0!==t?t:"Unknown"},{name:"Laterality",value:null!==(n=s.Laterality)&&void 0!==n?n:"Unknown"},{name:"Clinical TNM",value:oe(s)},{name:"Estrogen Receptor",value:null!==(a=s["Estrogen Receptor"])&&void 0!==a?a:"Unknown"},{name:"Progesterone Receptor",value:null!==(i=s["Progesterone Receptor"])&&void 0!==i?i:"Unknown"},{name:"HER2 Receptor",value:null!==(o=s["HER2 Receptor"])&&void 0!==o?o:"Unknown"}],v=[{name:"Pathway Selected",value:null===u||void 0===u?void 0:u.pathway},{name:"Recommendation",value:null===u||void 0===u?void 0:u.node},{name:"Pathway Status",value:null===u||void 0===u?void 0:u.status}];return r.a.createElement("div",{className:Tt.a.reportModal},r.a.createElement("h1",null,"Pathway Report"),r.a.createElement("div",{className:Tt.a.sectionContainer},r.a.createElement(St,{icon:m.x,fields:d}),r.a.createElement(St,{icon:m.n,fields:p}),r.a.createElement(St,{icon:m.r,fields:v}),(null===u||void 0===u?void 0:u.notes)&&r.a.createElement(Rt,{icon:m.s,notes:null===u||void 0===u?void 0:u.notes})),r.a.createElement("div",{className:Tt.a.confirmationSection},r.a.createElement("i",null,"The above note will be written into the EHR and any procedure requests will be submitted."),r.a.createElement("div",{className:Tt.a.confirmationButtonGroup},r.a.createElement(wt,{size:"medium",type:"accept",onClick:c}),r.a.createElement(wt,{size:"medium",type:"decline",onClick:l}))))};var At=Object(a.memo)((function(e){var t,n=e.actionNode,i=e.isActionable,o=e.isCurrentNode,c=e.isAction,l=e.documentation,d=e.isAccepted,m=J(),p=m.note,v=m.setNote,f=Object(a.useState)(!1),y=Object(s.a)(f,2),b=y[0],E=y[1],g=se(),_=g.patientRecords,w=g.setPatientRecords,P=Re(),C=D().patient;p&&(p.node=n.label);var j=function(e){var t=Object(u.a)(_);if(p){var a,r,i=te(ne(p,_,p.status,null!==(a=null===p||void 0===p?void 0:p.notes)&&void 0!==a?a:"",n),n.label,C);t.push(i),null===P||void 0===P||null===(r=P.create)||void 0===r||r.call(P,i)}if("Accepted"===(null===p||void 0===p?void 0:p.status)&&(null===e||void 0===e?void 0:e.resource)){var o,c=function(e,t){var n=e.resourceType,a={id:Object(Y.a)(),resourceType:n,intent:"order",subject:{reference:"Patient/".concat(t)},status:"active",authoredOn:(new Date).toISOString(),meta:{lastUpdated:(new Date).toISOString()}};switch(n){case"ServiceRequest":var r=e.code;return Object(h.a)({},a,{code:r});case"MedicationRequest":var i=e.medicationCodeableConcept;return Object(h.a)({},a,{medicationCodeableConcept:i});case"CarePlan":var o=e.title;return Object(h.a)({},a,{title:o});default:throw Error("Translation for ".concat(n," not implemented."))}}(e.resource,C.id);t.push(c),null===P||void 0===P||null===(o=P.create)||void 0===o||o.call(P,c)}w(t),E(!1)};return r.a.createElement(r.a.Fragment,null,r.a.createElement(qt,{isAction:c,isActionable:i,isCurrentNode:o,actionNode:n,documentation:l,setComments:function(e){v((function(t){return Object(h.a)({},t,{notes:e})}))},comments:null!==(t=null===p||void 0===p?void 0:p.notes)&&void 0!==t?t:"",onAccept:function(){v((function(e){return Object(h.a)({},e,{status:"Accepted"})})),E(!0)},onDecline:function(){v((function(e){return Object(h.a)({},e,{status:"Declined"})})),E(!0)},isAccepted:d,onAdvance:function(){var e,t=ee("".concat(n.label," - Advance"),C);null===P||void 0===P||null===(e=P.create)||void 0===e||e.call(P,t),w([].concat(Object(u.a)(_),[t]))}}),b&&r.a.createElement(Mt,{onConfirm:function(){return j(n.action)},onDecline:function(){return E(!1)}}))})),Lt=function(e){var t=e.title,n=e.description;return r.a.createElement("tr",null,r.a.createElement("td",{className:Ot.a.descTitle},t),r.a.createElement("td",{className:Ot.a.desc},n))},It=function(e){var t,n,a=e.documentation,i=e.isAccepted;if(!(null===a||void 0===a?void 0:a.resource))return null;var o=a.status,c=null===(t=a.resource)||void 0===t?void 0:null===(n=t.meta)||void 0===n?void 0:n.lastUpdated;if(c){var l=new Date(c).toLocaleString("en-us"),u="";return u=i?o.charAt(0).toUpperCase()+o.slice(1):null===i?"Status":"Declined",r.a.createElement(Lt,{key:"Status",title:u,description:i?l:l.concat(" by Dr. Example")})}return null};var qt=Object(a.memo)((function(e){var t,n=e.documentation,a=e.actionNode,i=e.isAction,o=e.isActionable,c=e.isCurrentNode,l=e.comments,u=e.setComments,s=e.onAccept,p=e.onDecline,v=e.isAccepted,f=e.onAdvance,h=se().patientRecords,y=i&&function(e,t,n){var a,i=e.action.resource,o=void 0;if(function(e){var t;return void 0!==(null===(t=e)||void 0===t?void 0:t.medicationCodeableConcept)}(i))o=null===i||void 0===i?void 0:null===(a=i.medicationCodeableConcept)||void 0===a?void 0:a.coding;else if(function(e){var t;return void 0!==(null===(t=e)||void 0===t?void 0:t.code)}(i)){var c;o=null===i||void 0===i?void 0:null===(c=i.code)||void 0===c?void 0:c.coding}else o=[{display:null===i||void 0===i?void 0:i.title}];var l=[r.a.createElement(Lt,{key:"Description",title:"Description",description:e.action.description}),r.a.createElement(Lt,{key:"Type",title:"Type",description:i.resourceType})];if(o){var u=[r.a.createElement(Lt,{key:"System",title:"System",description:r.a.createElement(r.a.Fragment,null,o&&o[0].system,r.a.createElement("a",{href:o&&o[0].system,target:"_blank",rel:"noopener noreferrer"},r.a.createElement(d.a,{icon:m.j,className:Ot.a.externalLink})))}),r.a.createElement(Lt,{key:"Code",title:"Code",description:o&&o[0].code}),r.a.createElement(Lt,{key:"Display",title:"Display",description:o&&o[0].display})];l.push.apply(l,u)}if(null===t||void 0===t?void 0:t.resource)switch(t.resourceType){case"Procedure":var s=t.resource,p=s.performedPeriod&&s.performedPeriod.start||s.performedDateTime,v=s.performedPeriod&&s.performedPeriod.end;p&&l.push(r.a.createElement(Lt,{key:"Start",title:"Start",description:new Date(p).toLocaleString("en-us")})),v&&l.push(r.a.createElement(Lt,{key:"End",title:"End",description:new Date(v).toLocaleString("en-us")}));break;case"CarePlan":var f=t.resource.title;f&&l.push(r.a.createElement(Lt,{key:"Title",title:"Title",description:f}))}return l}(a,n),b="branch"===a.type&&function(e,t,n){var a=[];if(null===e||void 0===e?void 0:e.resource)switch(e.resourceType){case"Observation":var i,o=e.resource,c=null===(i=o.valueCodeableConcept)||void 0===i?void 0:i.coding;c&&a.push(r.a.createElement(Lt,{key:"ValueSystem",title:"System",description:r.a.createElement(r.a.Fragment,null,c[0].system,r.a.createElement("a",{href:c[0].system,target:"_blank",rel:"noopener noreferrer"},r.a.createElement(d.a,{icon:m.j,className:Ot.a.externalLink})))}),r.a.createElement(Lt,{key:"ValueCode",title:"Code",description:c[0].code}),r.a.createElement(Lt,{key:"ValueDisplay",title:"Display",description:c[0].display}));var l=o.effectiveDateTime;l&&a.push(r.a.createElement(Lt,{key:"Date",title:"Date",description:new Date(l).toLocaleString("en-us")}));break;case"DocumentReference":var u=e.resource,s=u.subject;s&&a.push(r.a.createElement(Lt,{key:"subject",title:"Subject",description:s.reference}));var p=u.identifier,v=null===p||void 0===p?void 0:p.find((function(e){return"pathways.documentreference"===e.system}));if(v){var f=atob(v.value);a.push(r.a.createElement(Lt,{key:"value",title:"Value",description:f}))}else{var h=u.content[0].attachment.data;h&&a.push(r.a.createElement(Lt,{key:"note",title:"Note",description:atob(h)}))}break;default:a.push(r.a.createElement(Lt,{key:"error",title:"Error",description:"Unsupported Resource Type"}))}else{var y=t.transitions.map((function(e){var t,n=null===(t=e.condition)||void 0===t?void 0:t.description;return n||""})).filter((function(e,t,n){return n.indexOf(e)===t}));a.push(r.a.createElement(Lt,{key:"value",title:"Value",description:r.a.createElement(Ct,{values:y})}))}return a}(n,a),E="The patient and I discussed the treatment plan, risks, benefits and alternatives.  The patient expressed understanding and wants to proceed.",g=ce(a.label,h);if(g){var _,w=null===(_=g.content[0].attachment)||void 0===_?void 0:_.data;w&&(t=(t=atob(w)).slice(t.indexOf("Notes: ")+7))}return r.a.createElement("div",{className:st.a.expandedNode},r.a.createElement("table",{className:Ot.a.infoTable},r.a.createElement("tbody",null,r.a.createElement(It,{documentation:n,isAccepted:v}),y||b,!o&&t&&/\S/.test(t)&&r.a.createElement(Lt,{key:"Comments",title:"Comments",description:t}))),a.transitions.length>0&&!o&&i&&c&&r.a.createElement(de.a,{className:"".concat(st.a.button," ").concat(Ot.a.button),variant:"contained",color:"primary",onClick:f},"Advance"),o&&i&&r.a.createElement("form",{className:Ot.a.commentsForm},r.a.createElement("div",null,r.a.createElement("label",null,"Comments:"),r.a.createElement(de.a,{className:"".concat(st.a.button," ").concat(Ot.a.button),onClick:function(e){e.preventDefault(),l.includes(E)||u(l+E)},variant:"contained",color:"primary"},"Use Default Text")),r.a.createElement("textarea",{className:Ot.a.comments,value:l,onChange:function(e){return u(e.target.value)}}),r.a.createElement("div",{className:Ot.a.footer},r.a.createElement(wt,{type:"accept",size:"large",onClick:s})),r.a.createElement("div",{className:Ot.a.footer},r.a.createElement(wt,{type:"decline",size:"large",onClick:p}))))})),Bt=At,zt=Object(k.a)((function(e){return{"not-on-patient-path":{backgroundColor:e.palette.background.default,color:e.palette.text.primary},"child-not-on-patient-path":{borderColor:e.palette.background.default}}}),{name:"Node"}),Ut=Object(a.memo)(Object(a.forwardRef)((function(e,t){var n=e.pathwayNode,a=e.documentation,i=e.isOnPatientPath,o=e.isCurrentNode,c=e.xCoordinate,l=e.yCoordinate,u=e.expanded,s=void 0!==u&&u,d=e.onClickHandler,m=n.label,p={top:l,left:c},v=zt(),f=i?lt.a.onPatientPath:Object(x.a)(lt.a.notOnPatientPath,v["not-on-patient-path"]),h=o&&!a,y=[lt.a.node,f],b="";s&&y.push(st.a.expanded),h?(y.push(lt.a.actionable),b=lt.a.childActionable):b=i?lt.a.childOnPatientPath:Object(x.a)(lt.a.childNotOnPatientPath,v["child-not-on-patient-path"]);var E="action"===n.type,g=i&&E&&!h?"DocumentReference"!==(null===a||void 0===a?void 0:a.resourceType):null;!1===g&&(y.push(lt.a.declined),s&&(b=lt.a.childDeclined));var _=null;return"action"in n?_=i?g:!(!E||!a)||null:!o&&a&&(_=!0),r.a.createElement("div",{className:y.join(" "),style:p,ref:t},r.a.createElement("div",{className:"".concat(st.a.nodeTitle," ").concat(d&&st.a.clickable),onClick:d},r.a.createElement("div",{className:st.a.iconAndLabel},r.a.createElement(Ft,{pathwayNode:n,isAction:E}),m),r.a.createElement(Ht,{status:_})),s&&r.a.createElement("div",{className:"".concat(lt.a.expandedNode," ").concat(b)},r.a.createElement(Bt,{actionNode:n,isActionable:h,isAction:E,documentation:a,isAccepted:g,isCurrentNode:o})))}))),Ft=function(e){var t=e.pathwayNode,n=e.isAction,a=m.l;if("Start"===t.label&&(a=m.o),n){var i=t;if(i.action){var o=i.action.resource.resourceType;"MedicationRequest"===o?a=m.q:"ServiceRequest"===o?a=m.t:"CarePlan"===o&&(a=m.a)}}return r.a.createElement(d.a,{icon:a,className:lt.a.icon})},Ht=function(e){var t=e.status;if(null===t)return null;var n=t?m.d:m.w;return r.a.createElement(d.a,{icon:n,className:lt.a.statusIcon})},Gt=Ut,Vt=n(301),Wt=n.n(Vt),Jt=function(e){var t=e.points,n=e.arrowheadId,a=e.widthOffset,i=t.map((function(e){return{x:e.x+a,y:e.y}})),o=i.length;i[o-1].y-=17.5;var c,l="M ".concat(i[0].x," ").concat(i[0].y," ");return c=o%3,l=i.reduce((function(e,t,n,a){return n%3!==c?e:"".concat(e," C ").concat(t.x," ").concat(t.y," ").concat(a[n+1].x," ").concat(a[n+1].y," ").concat(a[n+2].x,"\n        ").concat(a[n+2].y)}),l),r.a.createElement("path",{d:l,fill:"transparent",markerEnd:"url(#".concat(n,")")})},Qt=function(e){var t=e.edge,n=e.edgeName,a=e.isOnPatientPath,i=e.widthOffset,o=a?Wt.a.arrowOnPatientPath:Wt.a.arrow,c=n.replace(" ",""),l="arrowhead-".concat(c),u=t.label;return r.a.createElement("svg",{className:o},r.a.createElement(Jt,{points:t.points,arrowheadId:l,widthOffset:i}),u?r.a.createElement("text",{x:u.x+i,y:u.y},u.text):null,r.a.createElement("defs",null,r.a.createElement("marker",{id:l,className:Wt.a.arrowhead,markerWidth:"10",markerHeight:"7",refX:"0",refY:"3.5",orient:"auto"},r.a.createElement("polygon",{points:"0 0, 10 3.5, 0 7"}))))},Xt=n(1196),Yt=n.n(Xt),Kt=n(1197),Zt=n.n(Kt),$t=function(e){return Object.values(e.documentation).filter((function(e){return e.onPath})).map((function(e){return e.node}))},en=function(e,t){var n=$t(e),a=n.indexOf(t.start),r=n.indexOf(t.end);return-1!==a&&-1!==r&&a+1===r||!(a!==n.length-1||!e.currentNodes.includes(t.end))},tn=Object(a.memo)((function(e){var t,n,i,o=e.evaluatedPathway,c=e.interactive,l=void 0===c||c,u=e.expandCurrentNode,d=void 0===u||u,m=F();if(!o){if(!m.evaluatedPathway)return r.a.createElement("div",null,"No Pathway Loaded");o=m.evaluatedPathway}var p=se(),v=p.patientRecords,f=o.pathway,y=Object(a.useRef)(null),b=Object(a.useRef)({}),E=Object(a.useState)(null!==(t=null===y||void 0===y?void 0:null===(n=y.current)||void 0===n?void 0:null===(i=n.parentElement)||void 0===i?void 0:i.clientWidth)&&void 0!==t?t:0),g=Object(s.a)(E,2),_=g[0],w=g[1],P=Object(a.useCallback)((function(e){p.setEvaluatePath(!1),m.updateEvaluatedPathways({pathway:f,pathwayResults:e})}),[f,m,p]),C=Object(a.useCallback)((function(){var e={};return(null===b||void 0===b?void 0:b.current)&&Object.keys(b.current).forEach((function(t){var n=b.current[t],a=n.clientWidth,r=Array.from(n.children).reduce((function(e,t){return e+t.clientHeight}),0);e[t]={width:a,height:r}})),ot(f,e)}),[f]),j=Object(a.useState)(C()),O=Object(s.a)(j,2),N=O[0],k=O[1],x=N.nodeCoordinates,R=N.edges,S=Object(a.useMemo)((function(){return void 0!==x?Object.values(x).map((function(e){return e.y})).reduce((function(e,t){return Math.max(e,t)})):0}),[x]),D=void 0!==x?Object.values(x).map((function(e){return e.x+_/2})).reduce((function(e,t){return Math.min(e,t)})):0;if(D<0){var T=-1*D;Object.keys(x).forEach((function(e){x[e].x+=T})),Object.keys(R).forEach((function(e){var t=R[e];t.points.forEach((function(e){return e.x+=T})),t.label&&(t.label.x+=T)}))}var M=Object.keys(N).toString(),A=Object(a.useMemo)((function(){return M.split(",").reduce((function(e,t){return e[t]=!1,e}),{})}),[M]),L=Object(a.useState)(A),I=Object(s.a)(L,2),q=I[0],B=I[1],z=Object(a.useCallback)((function(e,t){B((function(n){return Object(h.a)({},n,Object(nt.a)({},e,null!==t&&void 0!==t?t:!n[e]))}))}),[]);Object(a.useEffect)((function(){var e,t=!1;if(v.length>0&&(!(null===(e=o)||void 0===e?void 0:e.pathwayResults)||p.evaluatePath))return function(e,t,n){var a;return((null===(a=t.elm)||void 0===a?void 0:a.navigational)?Qe(e,t.elm.navigational):Me(t).then((function(t){return Je(e,t)}))).then((function(e){return Fe(t,e,n)}))}({resourceType:"Bundle",type:"searchset",entry:v.map((function(e){return{resource:e}}))},f,v).then((function(e){t||P(e)})),function(){t=!0}}),[f,v,o,P,p]),Object(a.useEffect)((function(){var e;if(null===(e=o)||void 0===e?void 0:e.pathwayResults){var t=!0,n=!1,a=void 0;try{for(var r,i=o.pathwayResults.currentNodes[Symbol.iterator]();!(t=(r=i.next()).done);t=!0){var c=r.value;d&&c&&z(c,!0)}}catch(l){n=!0,a=l}finally{try{t||null==i.return||i.return()}finally{if(n)throw a}}}}),[d,o,z]),Object(a.useEffect)((function(){var e;(null===(e=y.current)||void 0===e?void 0:e.parentElement)&&new Zt.a(y.current.parentElement,(function(){var e,t,n;w(null!==(e=null===(t=y.current)||void 0===t?void 0:null===(n=t.parentElement)||void 0===n?void 0:n.clientWidth)&&void 0!==e?e:0),k(C())}))}),[C]),Object(a.useEffect)((function(){k(C())}),[q,C]);var U=void 0!==R?Object.values(R).map((function(e){return e.label})).map((function(e){return e?e.x+10*e.text.length+_/2:0})).reduce((function(e,t){return Math.max(e,t)}),0):_,H=o.pathwayResults?o.pathwayResults.documentation:{};return r.a.createElement(nn,{graphElement:y,interactive:l,maxHeight:S,nodeCoordinates:x,documentation:H,edges:R,evaluatedPathway:o,nodeRefs:b,parentWidth:_,maxWidth:U,pathway:f,expanded:q,setExpanded:z})})),nn=Object(a.memo)((function(e){var t=e.graphElement,n=e.interactive,i=e.maxHeight,o=e.nodeCoordinates,c=e.documentation,l=e.edges,u=e.evaluatedPathway,s=e.nodeRefs,d=e.parentWidth,m=e.maxWidth,p=e.pathway,v=e.expanded,f=e.setExpanded;return r.a.createElement("div",{ref:t,id:"graph-root",className:Yt.a.root,style:{height:n?i+150:"inherit",width:m+"px",position:"relative",marginRight:"5px"}},void 0!==o?Object.keys(o).map((function(e){var t=c[e],i=Object(a.useCallback)((function(){return n?f(e):void 0}),[e]);return r.a.createElement(W,{date:new Date(Date.now()),key:e},r.a.createElement(Gt,{key:e,documentation:t,ref:function(t){s.current[e]=t},pathwayNode:p.nodes[e],isOnPatientPath:!!u.pathwayResults&&($t(u.pathwayResults).includes(e)||u.pathwayResults.currentNodes.includes(e)),isCurrentNode:!!u.pathwayResults&&u.pathwayResults.currentNodes.includes(e),xCoordinate:o[e].x+d/2,yCoordinate:o[e].y,expanded:v[e],onClickHandler:i}))})):[],r.a.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",style:{width:m+5,height:i,zIndex:1,top:0,left:0,overflow:"visible"}},void 0!==l?Object.keys(l).map((function(e){var t=l[e];return r.a.createElement(Qt,{key:e,edge:t,edgeName:e,isOnPatientPath:!!u.pathwayResults&&en(u.pathwayResults,t),widthOffset:d/2})})):[]))})),an=tn,rn=n(74),on=n.n(rn),cn=Object(k.a)((function(e){return{"pathway-element":{backgroundColor:e.palette.background.default},"assigned-pathway-element":{backgroundColor:e.palette.primary.main},title:{color:e.palette.text.primary},"assigned-title":{color:e.palette.common.white}}}),{name:"PathwaysList"}),ln=function(e){var t=e.evaluatedPathway,n=e.preconditions,i=e.callback,o=e.assigned,c=cn(),l=t.pathway,u=F(),p=u.setEvaluatedPathway,v=u.assignPathway,f=u.unassignPathway,h=Object(a.useState)(!1),y=Object(s.a)(h,2),b=y[0],E=y[1],g=b?m.g:m.e;var _=Object(x.a)(o&&on.a.assignedPathwayElement,o&&c["assigned-pathway-element"],!o&&on.a.pathwayElement,!o&&c["pathway-element"]),w=Object(x.a)(on.a.title,o&&c["assigned-title"],!o&&c.title);return r.a.createElement("div",{className:_,role:"list",key:l.name},r.a.createElement("div",{className:w,role:"listitem",onClick:function(e){p(t,!0),E(!b)}},r.a.createElement("div",null,l.name),o&&r.a.createElement(d.a,{icon:m.d}),r.a.createElement("div",{className:on.a.expand},r.a.createElement(d.a,{icon:g})),r.a.createElement("div",{className:on.a.numElements},null===n||void 0===n?void 0:n.matches)),b&&r.a.createElement("div",{className:on.a.infoContainer},r.a.createElement("div",{className:on.a.details},r.a.createElement("p",null,l.description),r.a.createElement("table",null,r.a.createElement("tbody",null,r.a.createElement("tr",null,r.a.createElement("th",null),r.a.createElement("th",null,"mCODE elements"),r.a.createElement("th",null,"patient elements")),null===n||void 0===n?void 0:n.preconditionResultItems.map((function(e){return r.a.createElement("tr",{key:e.elementName},r.a.createElement("td",null,e.elementName),r.a.createElement("td",null,e.expected),r.a.createElement("td",{className:e.match?on.a.matchingElement:void 0},e.actual))})))),r.a.createElement(de.a,{onClick:function(){o?f(l.name):v(l.name)},variant:"contained",color:o?"secondary":"primary",startIcon:r.a.createElement(d.a,{icon:o?m.w:m.d})},o?"Unassign":"Assign"),r.a.createElement(de.a,{onClick:function(){i(t)},variant:"contained",color:"primary",startIcon:r.a.createElement(d.a,{icon:m.k})},"View")),r.a.createElement("div",{className:on.a.pathway},r.a.createElement("div",{style:{height:"100%",overflow:"scroll"}},r.a.createElement(an,{evaluatedPathway:t,interactive:!1,expandCurrentNode:!1})),r.a.createElement("div",{className:on.a.controls},r.a.createElement(d.a,{icon:m.o}),r.a.createElement(d.a,{icon:m.p}),r.a.createElement(d.a,{icon:m.m})))))},un=function(e){var t=e.evaluatedPathways,n=e.callback,i=e.service,o=e.headerElement,c=se().patientRecords,l=Object(a.useState)(null),u=Object(s.a)(l,2),p=u[0],v=u[1];if(!p&&t.length>0&&c&&c.length>0){var f={resourceType:"Bundle",type:"searchset",entry:c.map((function(e){return{resource:e}}))},h=t.map((function(e){return We(f,e.pathway)}));Promise.all(h).then((function(e){v(e.sort((function(e,t){return t.matches-e.matches})))}))}var y=function(e,t){var n=e.filter((function(e){return"CarePlan"===e.resourceType})).filter((function(e){return"active"===e.status})).map((function(e){return e.title}));return t.map((function(e){return e.pathway.name})).filter((function(e){return n.includes(e)}))}(c,t),b={height:"100%"};return(null===o||void 0===o?void 0:o.current)&&(b.height=window.innerHeight-o.current.clientHeight+"px"),r.a.createElement("div",{className:on.a.pathways_list,style:b},"loading"===i.status?r.a.createElement("div",null,"Loading..."):"loaded"===i.status?r.a.createElement("div",{className:on.a.container},r.a.createElement("div",{className:on.a.pathwayListHeaderContainer},r.a.createElement("div",{className:on.a.header_title},r.a.createElement("div",{className:on.a.header_title__header},"Explore Pathways"),r.a.createElement("div",{className:on.a.header_title__note},"Select pathway below to view details")),r.a.createElement("div",{className:on.a.matchedElementsLabel},r.a.createElement("i",null,"mCODE",r.a.createElement("br",null),"elements",r.a.createElement("br",null),"matched"),r.a.createElement(d.a,{icon:m.b}))),0!==(null===p||void 0===p?void 0:p.length)&&r.a.createElement("div",null,p?p.map((function(e){var a=t.find((function(t){return t.pathway.name===e.pathwayName}));if(a){var i=a.pathway.name;return r.a.createElement(ln,{evaluatedPathway:a,callback:n,preconditions:e,assigned:y.includes(i),key:i})}return r.a.createElement("div",null,"An error occured evaluating the pathway preconditions. Please try again.")})):r.a.createElement("div",null,"Loading Pathways..."))):r.a.createElement("div",null,"ERROR"))};var sn=function(e){var t=Object(a.useState)({status:"loading"}),n=Object(s.a)(t,2),r=n[0],i=n[1];return Object(a.useEffect)((function(){(function(e){return fetch(e,{headers:{Accept:"application/json"}})})(e).then((function(e){return e.json()})).then((function(t){return t.map((function(t){return function(e,t){return fetch(e,t).then((function(e){return e.json()}))}(e+"/"+t)}))})).then((function(e){return Promise.all(e)})).then((function(e){return i({status:"loaded",payload:e})})).catch((function(e){return i({status:"error",error:e})}))}),[e]),r},dn=n(1198),mn=n.n(dn),pn=n(180),vn=n.n(pn),fn=n(82),hn=n(181),yn=function(){function e(){Object(fn.a)(this,e),this.patient={}}return Object(hn.a)(e,[{key:"create",value:function(){return vn.a.async((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("Mocked create"),e.abrupt("return",Promise.resolve({}));case 2:case"end":return e.stop()}}))}},{key:"delete",value:function(){return vn.a.async((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("Mocked delete"),e.abrupt("return",Promise.resolve({}));case 2:case"end":return e.stop()}}))}}]),e}(),bn=n(423),En=n.n(bn),gn=function(e){var t=e.headerElement,n=e.graphContainerElement;return r.a.createElement("div",{className:En.a.display},r.a.createElement(tt,{headerElement:t}),r.a.createElement("div",{ref:n,className:En.a.graph},r.a.createElement(an,{expandCurrentNode:!0})))};var _n=function(e){var t,n=e.demoId,i=Object(a.useState)(null),o=Object(s.a)(i,2),c=o[0],l=o[1],d=Object(a.useState)([]),m=Object(s.a)(d,2),p=m[0],v=m[1],f=Object(a.useState)({}),h=Object(s.a)(f,2),y=h[0],b=h[1],E=Object(a.useState)(null),g=Object(s.a)(E,2),_=g[0],w=g[1],P=Object(a.useState)(!0),j=Object(s.a)(P,2),O=j[0],k=j[1],x=Object(a.useState)(!1),R=Object(s.a)(x,2),D=R[0],T=R[1],M=Object(a.useState)([]),A=Object(s.a)(M,2),L=A[0],I=A[1],q=Object(a.useState)(null),B=Object(s.a)(q,2),z=B[0],F=B[1],H=Object(a.useState)(""),V=Object(s.a)(H,2),W=V[0],J=V[1],Q=Object(a.useRef)(null),Y=Object(a.useRef)(null),K=Object(a.useCallback)((function(e){v(e),T(!0)}),[]),ee=Object(a.useCallback)((function(e){var t,n={resourceType:"Bundle",type:"searchset",entry:e.map((function(e){return{resource:e}}))};(t="elm/mCODE.elm.json",fetch("./static/cql/".concat(t)).then((function(e){return e.text()}))).then((function(e){var t,a,r,i,o,c,l,u,s=JSON.parse(e),d=Ue(n,s),m=Object.keys(d.patientResults),p=d.patientResults[m[0]],v={"Primary Cancer":null!==(t=p["Primary Cancer Condition Value"][0])&&void 0!==t?t:void 0,Laterality:null!==(a=p["Primary Cancer Condition Body Location Value"][0])&&void 0!==a?a:void 0,"Tumor Category":null!==(r=p["TNM Clinical Primary Tumor Category Data Value (T Category)"][0])&&void 0!==r?r:void 0,"Node Category":null!==(i=p["TNM Clinical Regional Nodes Category Data Value (N Category)"][0])&&void 0!==i?i:void 0,"Metastases Category":null!==(o=p["TNM Clinical Distant Metastases Category Data Value (M Category)"][0])&&void 0!==o?o:void 0,"Estrogen Receptor":null!==(c=p["Estrogen Receptor Value"][0])&&void 0!==c?c:void 0,"Progesterone Receptor":null!==(l=p["Progesterone Receptor Value"][0])&&void 0!==l?l:void 0,"HER2 Receptor":null!==(u=p["HER2 Receptor Value"][0])&&void 0!==u?u:void 0};b(v)}))}),[]),te=Object(a.useMemo)((function(){return{patientRecords:p,setPatientRecords:K,evaluatePath:D,setEvaluatePath:T,mcodeRecords:y,setMcodeRecords:ee}}),[p,K,D,T,y,ee]);Object(a.useEffect)((function(){if(n){F(new yn);var e=_e.a.get("demoPatients")+n+".json";fetch(e).then((function(e){return e.json()})).then((function(e){var t=e.find((function(e){return"Patient"===e.resourceType}));K(e),ee(e),l(t)}))}else mn.a.oauth2.init({clientId:"Input client id you get when you register the app",scope:"launch/patient openid profile"}).then((function(e){var t,n;(function(e){return e.request("/metadata").then((function(t){if(t.rest[0].operation.find((function(e){return"OperationDefinition/Patient--everything"===(e.definition.reference||e.definition)})))return function(e){return e.request("/Patient/".concat(e.patient.id,"/$everything"),{flat:!0,pageLimit:0}).then((function(e){return e}))}(e).then((function(e){return je(e)}));console.log("Cannot use $everything, using reverse includes instead");var n=[],a=[];return t.rest[0].resource.forEach((function(e){if("Patient"===e.type)e.searchRevInclude&&(a=e.searchRevInclude);else if(e.searchInclude){var t=e.searchInclude.filter((function(t){return t==="".concat(e.type,":patient")||t==="".concat(e.type,":subject")}));t.length>0&&n.push(t[0])}else if(e.searchParam){var r=e.searchParams.filter((function(e){return"patient"===e.name||"subject"===e.name}));r.length>0&&n.push("".concat(e.type,":").concat(r[0].name))}})),a.length>0?Ne(e,a,Oe).then((function(e){return je(e)})):n.length>0?Ne(e,n,Oe).then((function(e){return je(e)})):(console.log("Cannot use reverse includes, retrieving all resources manually from predefined list"),Oe(e,Ee).then((function(e){return je(e)})))}))})(e).then((function(e){var t=["id","meta","resourceType"];e=e.filter((function(e){return!Object.keys(e).every((function(e){return t.includes(e)}))})),K(e),ee(e)})),null===(t=e.patient)||void 0===t||null===(n=t.read)||void 0===n||n.call(t).then((function(e){return l(e)})),F(e)}))}),[n,K,ee]),Object(a.useEffect)((function(){var e;null===z||void 0===z||null===(e=z.user)||void 0===e||e.read().then((function(e){var t=e.name&&$(e.name);t&&J(t)}))}),[z]);var ne=sn(_e.a.get(n?"demoPathwaysService":"pathwaysService"));function ae(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];window.scrollTo(0,0),k(t),w(e)}Object(a.useEffect)((function(){"loaded"===ne.status&&0===L.length&&I(ne.payload.map((function(e){return{pathway:e,pathwayResults:null}})))}),[ne,L.length,z,p]),Object(a.useEffect)((function(){(null===Y||void 0===Y?void 0:Y.current)&&(null===Q||void 0===Q?void 0:Q.current)&&(Y.current.style.height=window.innerHeight-Q.current.clientHeight+"px")}),[O]);var re=Object(a.useCallback)((function(e){for(var t=Object(u.a)(L),n=0;n<L.length;n++)L[n].pathway.name===e.pathway.name&&(t[n]=e,I(t));(null===_||void 0===_?void 0:_.pathway.name)===e.pathway.name&&w(e)}),[_,L]),ie=Object(a.useCallback)((function(e){var t;if(c){var n=function(e,t){return{title:e,resourceType:"CarePlan",id:Z.a.generate(),text:{status:X.R4.NarrativeStatusKind._generated,div:"<div> Assignment of patient to pathway ".concat(e," </div>")},status:"active",intent:"plan",category:[{coding:[{system:"http://hl7.org/fhir/us/core/CodeSystem/careplan-category",code:"assess-plan"}]}],subject:{reference:"Patient/".concat(t.id)}}}(e,c);K([].concat(Object(u.a)(p),[n])),null===z||void 0===z||null===(t=z.create)||void 0===t||t.call(z,n)}}),[p,c,z,K]),oe=Object(a.useCallback)((function(e){var t=[];p.forEach((function(n){var a;"CarePlan"===n.resourceType&&n.title===e?null===z||void 0===z||null===(a=z.delete)||void 0===a||a.call(z,"CarePlan/".concat(n.id)):t.push(n)})),K(t)}),[p,K,z]);return r.a.createElement(C,null,r.a.createElement(xe,{client:z},r.a.createElement(G,{value:{user:W,setUser:J}},r.a.createElement(S,{value:{patient:c,setPatient:l}},r.a.createElement(ue,{value:te},r.a.createElement(U,{pathwayCtx:{updateEvaluatedPathways:re,evaluatedPathway:_,setEvaluatedPathway:ae,assignPathway:ie,unassignPathway:oe}},r.a.createElement("div",{ref:Q},r.a.createElement(N,{logo:be.a}),r.a.createElement(he,{evaluatedPathways:L,selectPathway:O,setSelectPathway:k})),O?r.a.createElement(un,{evaluatedPathways:L,callback:ae,service:ne,headerElement:Q}):r.a.createElement(gn,{key:null!==(t=null===_||void 0===_?void 0:_.pathway.name)&&void 0!==t?t:"",headerElement:Q,graphContainerElement:Y})))))))},wn=document.getElementById("root");o.a.render(r.a.createElement(c.a,null,r.a.createElement(l.c,null,r.a.createElement(l.a,{exact:!0,path:"/",render:function(){return r.a.createElement(_n,null)}}),r.a.createElement(l.a,{path:"/demo/:id",render:function(e){return r.a.createElement(_n,{demoId:e.match.params.id,key:e.match.params.id})}}),r.a.createElement(l.a,{path:"/demo",render:function(){return r.a.createElement(_n,{demoId:"Maureen"})}}))),wn)},184:function(e,t,n){e.exports={selectButton:"ActionButton_selectButton___qB5R",accept:"ActionButton_accept__28b2D",decline:"ActionButton_decline__zz-vG",smallActionButton:"ActionButton_smallActionButton__1bPWu",largeActionButton:"ActionButton_largeActionButton__blRdA",largeDecline:"ActionButton_largeDecline__wz9Zw",mediumActionButton:"ActionButton_mediumActionButton__3EpOp"}},208:function(e,t,n){e.exports={patientSnapshot:"PatientSnapshot_patientSnapshot__3bGcm",patientSnapshot__info:"PatientSnapshot_patientSnapshot__info__2Ry7e",patientName:"PatientSnapshot_patientName__ZClJB",patientSnapshot__photo:"PatientSnapshot_patientSnapshot__photo__3XI7U",patientSnapshot__list:"PatientSnapshot_patientSnapshot__list__5DVC3"}},237:function(e,t,n){e.exports={navigation:"Navigation_navigation__1EgxP",navigation__back:"Navigation_navigation__back__2cVZ2",navigation__leftPanel:"Navigation_navigation__leftPanel__QjHPF",navigation__rightPanel:"Navigation_navigation__rightPanel__1FRD3"}},239:function(e,t,n){e.exports={reportModal:"ReportModal_reportModal__2hppG",sectionContainer:"ReportModal_sectionContainer__1iIQM",confirmationSection:"ReportModal_confirmationSection__2HXo4",confirmationButtonGroup:"ReportModal_confirmationButtonGroup__1FN9I"}},301:function(e,t,n){e.exports={arrow:"Arrow_arrow__3TM91",arrowhead:"Arrow_arrowhead__3XjQ0",arrowOnPatientPath:"Arrow_arrowOnPatientPath__1r5CB"}},417:function(e,t,n){e.exports={dropdown:"DropDown_dropdown__1KvCw",check:"DropDown_check__2pubh"}},423:function(e,t,n){e.exports={display:"App_display__2vneK",graph:"App_graph__3EP_l"}},74:function(e,t,n){e.exports={pathways_list:"PathwaysList_pathways_list__2WO5g",header_title:"PathwaysList_header_title__7EM8s",header_title__header:"PathwaysList_header_title__header__36yqh",header_title__note:"PathwaysList_header_title__note__34zC8",container:"PathwaysList_container__1SC5K",assignedPathwayElement:"PathwaysList_assignedPathwayElement__2xpdU",title:"PathwaysList_title__ccVmw",numElements:"PathwaysList_numElements__1WAOk",expand:"PathwaysList_expand__2v9Wx",infoContainer:"PathwaysList_infoContainer__2q0Tn",details:"PathwaysList_details__2kSzT",pathway:"PathwaysList_pathway__1vqM1",matchingElement:"PathwaysList_matchingElement__1SQoM",controls:"PathwaysList_controls__vZmz8",pathwayElement:"PathwaysList_pathwayElement__34hJh",matchedElementsLabel:"PathwaysList_matchedElementsLabel__3cXeX",pathwayListHeaderContainer:"PathwaysList_pathwayListHeaderContainer__2l2fi"}}},[[1211,1,2]]]);
//# sourceMappingURL=main.4f9549a2.chunk.js.map