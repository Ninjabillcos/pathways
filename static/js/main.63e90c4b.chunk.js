(this.webpackJsonppathways=this.webpackJsonppathways||[]).push([[0],{106:function(e,t,n){e.exports={node:"Node_node__38uoJ",icon:"Node_icon__354W4",statusIcon:"Node_statusIcon__NkBGU",onPatientPath:"Node_onPatientPath__3LPjE",actionable:"Node_actionable__bHXKd",declined:"Node_declined__2Dd-4",notOnPatientPath:"Node_notOnPatientPath__24OpF",expandedNode:"Node_expandedNode__1ar-A",childOnPatientPath:"Node_childOnPatientPath__28UD6",childActionable:"Node_childActionable__SwUjD",childNotOnPatientPath:"Node_childNotOnPatientPath__2j4QB",childDeclined:"Node_childDeclined__2Gx9j"}},119:function(e,t,n){e.exports={infoTable:"ExpandedNode_infoTable__3v2tx",descTitle:"ExpandedNode_descTitle__15ki8",desc:"ExpandedNode_desc__3Xdkf",externalLink:"ExpandedNode_externalLink__1Mr1x",button:"ExpandedNode_button__Tvpk5",commentsForm:"ExpandedNode_commentsForm__3Q20Y",footer:"ExpandedNode_footer__FOCYI",comments:"ExpandedNode_comments__9q-JW"}},1276:function(e,t,n){},1279:function(e,t,n){e.exports=n.p+"static/media/camino-logo-dark.c8fc712a.png"},1282:function(e,t,n){e.exports={pathwayPopup:"PathwayPopup_pathwayPopup__2moYb"}},1291:function(e,t,n){e.exports={root:"Graph_root__1SJOc"}},1306:function(e,t,n){e.exports=n(1915)},137:function(e,t,n){e.exports={expanded:"styles_expanded__XNUv-",expandedNode:"styles_expandedNode__26Fy8",nodeTitle:"styles_nodeTitle__5mm8f",clickable:"styles_clickable__3HzZZ",iconAndLabel:"styles_iconAndLabel__2LOTu",statusIcon:"styles_statusIcon__2jDwI",button:"styles_button__1AUjr"}},139:function(e,t,n){e.exports={record:"PatientRecord_record__2CgGD",recordToggle:"PatientRecord_recordToggle__2Vhvd",sidebar:"PatientRecord_sidebar__1Box0",element:"PatientRecord_element__RKq2B",title:"PatientRecord_title__2U0uE",expand:"PatientRecord_expand__M9HFP",visualizerContainer:"PatientRecord_visualizerContainer__PamdD"}},140:function(e,t,n){e.exports={fieldContainer:"ReportSection_fieldContainer__3LwUq",field:"ReportSection_field__Cxwdy",sectionContainer:"ReportSection_sectionContainer__3gJ8s",sectionIconContainer:"ReportSection_sectionIconContainer__3pp4w",icon:"ReportSection_icon__1NGg-",notesField:"ReportSection_notesField__67Cly"}},149:function(e,t,n){"use strict";(function(e){var a=n(58),i=n(85),r=n(185),o=new(function(){function t(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Object(i.a)(this,t),this.config=e.CONFIG?Object(a.a)({},e.CONFIG,{},n):Object(a.a)({},n)}return Object(r.a)(t,[{key:"get",value:function(e,t){var n=e.split("."),a=this.config,i=null;for(var r in n){a=i=a[n[r]]}return i||t}},{key:"add",value:function(e){e&&(this.config=Object(a.a)({},this.config,{},e))}}]),t}());t.a=o}).call(this,n(86))},1680:function(e,t){},1682:function(e,t){},1703:function(e,t){},174:function(e,t,n){e.exports={missingDataPopup:"MissingDataPopup_missingDataPopup__A-EBJ",popupContent:"MissingDataPopup_popupContent__24BvC",popupTrigger:"MissingDataPopup_popupTrigger__11eAy",popupChoice:"MissingDataPopup_popupChoice__5oEld",selected:"MissingDataPopup_selected__20Or7",footer:"MissingDataPopup_footer__1wJXm",externalLink:"MissingDataPopup_externalLink__3oYt-"}},188:function(e,t,n){e.exports={selectButton:"ActionButton_selectButton___qB5R",accept:"ActionButton_accept__28b2D",decline:"ActionButton_decline__zz-vG",smallActionButton:"ActionButton_smallActionButton__1bPWu",largeActionButton:"ActionButton_largeActionButton__blRdA",largeDecline:"ActionButton_largeDecline__wz9Zw",mediumActionButton:"ActionButton_mediumActionButton__3EpOp"}},1915:function(e,t,n){"use strict";n.r(t);n(1307),n(1315);var a=n(0),i=n.n(a),r=n(46),o=n.n(r),c=n(1294),s=n(172),l=n(171),u=n(43),d=n(42),m=n(31),p=n(1947),v=n(1950),f=n(1943),h=n(58),y=n(1296),b={white:"#fff",black:"#222",blue:"#5d89a1",red:"#d95d77",gray:"#4a4a4a",grayMedium:"#bbbdc0",grayBlue:"#cbd5df",grayLighter:"#eaeef2",green:"#2fa874"},g={fontFamily:"'Open Sans', -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Oxygen', 'Ubuntu', 'Cantarell', 'Fira Sans', 'Droid Sans', 'Helvetica Neue', sans-serif"},j={MuiButton:{root:{borderRadius:0},label:{fontWeight:600},iconSizeMedium:{"& > *:first-child":{fontSize:14}},iconSizeSmall:{"& > *:first-child":{fontSize:14}}}},E=Object(y.a)({typography:Object(h.a)({},g),palette:{primary:{main:b.blue},secondary:{main:b.red},common:b,background:{default:b.grayLighter},text:{primary:b.gray,secondary:b.gray}},overrides:Object(h.a)({},j)}),_=Object(y.a)({typography:Object(h.a)({},g),palette:{primary:{main:b.blue},secondary:{main:b.red},common:b,background:{default:b.grayBlue},text:{primary:b.black,secondary:b.black}},overrides:Object(h.a)({},j)}),w=Object(a.createContext)((function(){})),P=function(e){var t=e.children,n=Object(a.useState)(E),r=Object(u.a)(n,2),o=r[0],c=r[1],s=Object(a.useCallback)((function(){c((function(e){return e===E?_:E}))}),[]);return i.a.createElement(f.a,{theme:o},i.a.createElement(w.Provider,{value:s},t))},C=n(1276),O=n.n(C),N=function(e){var t=Object(a.useState)(null),n=Object(u.a)(t,2),r=n[0],o=n[1],c=Object(a.useContext)(w),s=function(){o(null)};return i.a.createElement("header",{className:O.a.header},i.a.createElement("img",{src:e.logo,alt:"logo"}),i.a.createElement("button",{onClick:function(e){o(e.currentTarget)},"aria-controls":"options-menu","aria-haspopup":"true"},i.a.createElement(d.a,{icon:m.h})),i.a.createElement(p.a,{id:"options-menu",anchorEl:r,keepMounted:!0,open:Boolean(r),onClose:s},i.a.createElement(v.a,{onClick:function(){c(),s()}},"Toggle Theme")))},k=n(1945),x=n(41),R=Object(a.createContext)({patient:null,setPatient:function(){}}),S=function(e){var t=e.children,n=e.value;return null==n.patient?i.a.createElement("div",null,"Loading..."):i.a.createElement(R.Provider,{value:n},t)},D=function(){return Object(a.useContext)(R)},T=n(212),M=n.n(T),A=Object(k.a)((function(e){return{"patient-snapshot-list":{color:e.palette.text.primary}}}),{name:"PatientSnapshot"}),q=function(){var e=A(),t=D().patient,n=Object(a.useMemo)((function(){return function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=e.find((function(e){return"official"===e.use}))||e[0];return t?"".concat((t.given||[]).join(" ")," ").concat(t.family):"No name"}(t.name)}),[t]),r=Object(a.useMemo)((function(){return function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=e[0];return t?[t.city,t.state].filter((function(e){return!!e})).join(", "):"No Address"}(t.address)}),[t]),o=Object(a.useMemo)((function(){return function(e){if(!e)return 0;var t=new Date,n=new Date(e),a=t.getFullYear()-n.getFullYear(),i=t.getMonth()-n.getMonth();return(i<0||0===i&&t.getDate()<n.getDate())&&a--,a}(t.birthDate)}),[t]);return i.a.createElement("div",{className:M.a.patientSnapshot},i.a.createElement(d.a,{icon:m.y,className:M.a.patientSnapshot__photo}),i.a.createElement("div",{className:M.a.patientSnapshot__info},i.a.createElement("div",{className:M.a.patientName},n),i.a.createElement("ul",{className:Object(x.a)(M.a.patientSnapshot__list,e["patient-snapshot-list"])},i.a.createElement("li",null,"DOB: ",t.birthDate," (Age: ",o,")"),i.a.createElement("li",null,"Admin. Sex: ",t.gender),i.a.createElement("li",null,"Location: ",r))))},L=n(1295),I=n(511),B=n.n(I),z=Object(a.createContext)({evaluatedPathway:null,setEvaluatedPathway:function(){},updateEvaluatedPathways:function(){},assignPathway:function(){},unassignPathway:function(){}}),U=function(e){var t=e.children,n=e.pathwayCtx;return i.a.createElement(z.Provider,{value:n},t)},F=function(){return Object(a.useContext)(z)},H=Object(a.createContext)({user:"",setUser:function(){}}),G=function(e){var t=e.children,n=e.value;return i.a.createElement(H.Provider,{value:n},t)},V=Object(a.createContext)({note:null,setNote:function(){}}),W=function(e){var t,n=e.children,r=e.date,o=D().patient,c=Object(a.useContext)(H).user,s=(null===o||void 0===o?void 0:o.name)?$(o.name):"",l=Object(a.useState)({patient:s,date:r.toDateString(),physician:c,birthdate:(null===o||void 0===o?void 0:o.birthDate)||"",mcodeElements:{},pathway:null===(t=F().evaluatedPathway)||void 0===t?void 0:t.pathway.name,status:"Pending"}),d=Object(u.a)(l,2),m=d[0],p=d[1];return i.a.createElement(V.Provider,{value:{note:m,setNote:p}},n)},J=function(){return Object(a.useContext)(V)},Q=function(e){var t="";return Object.keys(e.mcodeElements).forEach((function(n){t+="".concat(n,": ").concat(e.mcodeElements[n],"\n")})),"Date: ".concat(e.date,"\n\nPatient: ").concat(e.patient,"\n\nBirthdate: ").concat(e.birthdate,"\n\nPhysician: ").concat(e.physician,"\n\n").concat(t,"\nPathway: ").concat(e.pathway,"\n\nNode: ").concat(e.node,"\n\nStatus: ").concat(e.status,"\n\nTreatment: ").concat(e.treatment,"\n\nNotes: ").concat(e.notes)},X=n(1278),Y=n(1949),K=n(303),Z=n.n(K);function $(e){var t,n,a,i,r,o,c,s="";Array.isArray(e)&&(s=[null===(t=e[0])||void 0===t?void 0:null===(n=t.prefix)||void 0===n?void 0:n.join(" "),null===(a=e[0])||void 0===a?void 0:null===(i=a.given)||void 0===i?void 0:i.join(" "),null===(r=e[0])||void 0===r?void 0:r.family,null===(o=e[0])||void 0===o?void 0:null===(c=o.suffix)||void 0===c?void 0:c.join(" ")].join(" "));return s}function ee(e,t){return{resourceType:"DocumentReference",id:Object(Y.a)(),meta:{lastUpdated:ae()},status:"current",subject:{reference:"Patient/".concat(t.id)},content:[{attachment:{data:btoa(e),contentType:"text/plain"}}],type:{coding:[{system:"http://loinc.org",code:"34108-1",display:"Outpatient Note"}]},indexed:""}}function te(e,t,n){var a=ee(e,n);return Object(h.a)({},a,{identifier:[{system:"pathways.documentreference",value:btoa(t)}]})}function ne(e,t,n,a,i){e.status=n,e.notes=a,i&&(e.treatment=i.action[0].description,e.node=i.label);var r=["","",""];return t.forEach((function(t){var n;if((null===(n=t.meta)||void 0===n?void 0:n.profile)&&t.meta.profile.length){var a=["TNMClinicalPrimaryTumorCategory","TNMClinicalRegionalNodesCategory","TNMClinicalDistantMetastasesCategory"],i=t.meta.profile[0];if("Observation"===t.resourceType)if(i.includes("TumorMarkerTest")&&"Observation"===t.resourceType){var o,c=t,s=null===(o=c.valueCodeableConcept)||void 0===o?void 0:o.text,l=c.code.text;s&&l&&(e.mcodeElements[l]=s)}else if(a.some((function(e){return i.includes(e)}))){var u=a.findIndex((function(e){return i.includes(e)}));if(u>-1){var d,m=null===(d=t.valueCodeableConcept)||void 0===d?void 0:d.text;m&&(r[u]=m)}}}})),e.mcodeElements["Clinical TNM"]=r.join(" "),Q(e)}function ae(){var e=new Date;return e.getFullYear()+"-"+ie(e.getMonth())+"-"+ie(e.getDay())+"T"+ie(e.getUTCHours())+":"+ie(e.getUTCMinutes())+":"+ie(e.getUTCSeconds())+"."+e.getUTCMilliseconds()+"+00:00"}function ie(e){return e<10?"0"+e:e.toString()}function re(e,t){return!!t&&e.filter((function(e){return"CarePlan"===e.resourceType})).filter((function(e){return"active"===e.status})).map((function(e){return e.title})).includes(t.name)}function oe(e){var t,n,a,i=[null===(t=e["Tumor Category"])||void 0===t?void 0:t.split(" ")[0],null===(n=e["Node Category"])||void 0===n?void 0:n.split(" ")[0],null===(a=e["Metastases Category"])||void 0===a?void 0:a.split(" ")[0]].join(" ");return"   "===i?"Unknown":i}function ce(e,t){var n=t.find((function(t){if("DocumentReference"!==t.resourceType)return!1;var n=t;if(void 0===n.identifier)return!1;var a=!0,i=!1,r=void 0;try{for(var o,c=n.identifier[Symbol.iterator]();!(a=(o=c.next()).done);a=!0){var s=o.value;if("pathways.documentreference"===s.system&&s.value===btoa(e))return!0}}catch(l){i=!0,r=l}finally{try{a||null==c.return||c.return()}finally{if(i)throw r}}return!1}));return n||null}var se=Object(a.createContext)({patientRecords:[],setPatientRecords:function(){},evaluatePath:!0,setEvaluatePath:function(){},mcodeRecords:{},setMcodeRecords:function(){}}),le=function(e){var t=e.children,n=e.value;return i.a.createElement(se.Provider,{value:n},t)},ue=function(){return Object(a.useContext)(se)},de=n(1951),me=function(e){var t=e.options,n=e.label,r=e.id,o=e.visible,c=e.onChange,s=e.selectedValue,l=e.setSelectPathway,u=ue().patientRecords,p=F(),v=p.evaluatedPathway,f=p.assignPathway,h=p.unassignPathway,y=Object(a.useCallback)((function(e){c&&c(null==e?null:e)}),[c]),b=re(u,null===v||void 0===v?void 0:v.pathway);return o?i.a.createElement("div",{className:B.a.dropdown},i.a.createElement("div",null,i.a.createElement("label",{htmlFor:r},n),i.a.createElement(de.a,{onClick:function(){l(!0)},variant:"contained",color:"primary",startIcon:i.a.createElement(d.a,{icon:m.u})},"Explore"),i.a.createElement(de.a,{onClick:function(){(null===v||void 0===v?void 0:v.pathway)?b?h(v.pathway.name):f(v.pathway.name):alert("Unable to perform action. No pathway is selected.")},variant:"contained",color:b?"secondary":"primary",startIcon:i.a.createElement(d.a,{icon:b?m.w:m.d})},b?"Unassign":"Assign")),i.a.createElement(L.a,{classNamePrefix:"DropDown",inputId:r,value:s,onChange:y,options:t,"aria-label":n,formatOptionLabel:function(e){return i.a.createElement(i.a.Fragment,null,e.label,re(u,e.value.pathway)&&i.a.createElement(d.a,{icon:m.d,className:B.a.check}))}})):i.a.createElement("div",null)},pe=n(241),ve=n.n(pe),fe=Object(k.a)((function(e){return{navigation:{backgroundColor:e.palette.background.default,color:e.palette.text.primary}}}),{name:"Navigation"}),he=function(e){var t,n=e.evaluatedPathways,a=e.selectPathway,r=e.setSelectPathway,o=e.onBack,c=fe(),s=F(),l=null===(t=s.evaluatedPathway)||void 0===t?void 0:t.pathway,u=void 0===l?null:{label:l.name,value:s.evaluatedPathway},p=n.map((function(e){return{label:e.pathway.name,value:e}}));return i.a.createElement("nav",{className:Object(x.a)(ve.a.navigation,c.navigation)},i.a.createElement("div",{className:ve.a.navigation__leftPanel},o&&i.a.createElement(d.a,{icon:m.f,className:ve.a.navigation__back,onClick:o}),i.a.createElement(q,null)),i.a.createElement("div",{className:ve.a.navigation__rightPanel},i.a.createElement(me,{label:"Pathway:",id:"patient-view",visible:!a,options:p,selectedValue:u,setSelectPathway:r,onChange:function(e){null!==e&&"value"in e&&s.setEvaluatedPathway(e.value)}})))},ye=n(1279),be=n.n(ye),ge=["ReferralRequest:patient","DocumentManifest:patient","Goal:patient","Consent:patient","DocumentReference:patient","ImagingManifest:patient","RiskAssessment:patient","CareTeam:patient","ImagingStudy:patient","FamilyMemberHistory:patient","Encounter:patient","DeviceRequest:patient","AllergyIntolerance:patient","CarePlan:patient","EpisodeOfCare:patient","Procedure:patient","List:patient","Immunization:patient","VisionPrescription:patient","ProcedureRequest:patient","Flag:patient","Observation:patient","DiagnosticReport:patient","NutritionOrder:patient","Condition:patient","Composition:patient","DetectedIssue:patient","SupplyDelivery:patient","ClinicalImpression:patient","DeviceUseStatement:patient","Task:subject","Task:requester","Task:patient","Task:owner","Task:focus","Task:based-on","SupplyRequest:requester","Specimen:subject","Specimen:patient","ServiceDefinition:successor","ServiceDefinition:predecessor","ServiceDefinition:depends-on","ServiceDefinition:derived-from","ServiceDefinition:composed-of","Sequence:patient","Schedule:actor","RiskAssessment:subject","ResearchSubject:patient","ResearchSubject:individual","RequestGroup:subject","RequestGroup:participant","RequestGroup:patient","RequestGroup:definition","RelatedPerson:patient","ReferralRequest:subject","ReferralRequest:requester","QuestionnaireResponse:subject","QuestionnaireResponse:source","QuestionnaireResponse:patient","QuestionnaireResponse:author","Provenance:target","Provenance:entity-ref","Provenance:patient","Provenance:agent","ProcessResponse:request","ProcedureRequest:subject","ProcedureRequest:replaces","ProcedureRequest:performer","ProcedureRequest:based-on","Procedure:subject","Procedure:performer","PlanDefinition:successor","PlanDefinition:predecessor","PlanDefinition:derived-from","PlanDefinition:depends-on","PlanDefinition:composed-of","Person:patient","Person:link","PaymentNotice:response","PaymentNotice:request","Patient:link","Observation:subject","Observation:performer","MessageHeader:focus","MedicationStatement:source","MedicationStatement:subject","MedicationRequest:subject","MedicationRequest:requester","MedicationDispense:subject","MedicationDispense:receiver","MedicationDispense:performer","MedicationAdministration:subject","MedicationRequest:patient","MedicationAdministration:patient","MedicationStatement:patient","MedicationDispense:patient","MedicationAdministration:performer","Media:subject","Media:patient","MeasureReport:patient","Measure:successor","Measure:predecessor","Measure:derived-from","Measure:depends-on","Measure:composed-of","List:subject","List:item","List:source","Library:successor","Library:predecessor","Library:derived-from","Library:composed-of","Library:depends-on","ImplementationGuide:resource","ImmunizationRecommendation:patient","ImagingManifest:author","GuidanceResponse:subject","GuidanceResponse:patient","Group:member","Goal:subject","Flag:subject","Flag:author","ExplanationOfBenefit:patient","ExplanationOfBenefit:payee","EnrollmentRequest:subject","EnrollmentRequest:patient","Encounter:subject","EligibilityRequest:patient","DocumentReference:subject","DocumentReference:related-ref","DocumentReference:author","DocumentManifest:subject","DocumentManifest:related-ref","DocumentManifest:content-ref","DocumentManifest:recipient","DiagnosticReport:subject","DocumentManifest:author","DeviceUseStatement:subject","DeviceRequest:subject","DeviceRequest:priorrequest","DeviceRequest:performer","DeviceRequest:based-on","Device:patient","DetectedIssue:implicated","Coverage:subscriber","Coverage:policy-holder","Coverage:payor","Contract:term-topic","Coverage:beneficiary","Contract:subject","Contract:signer","Contract:patient","Contract:agent","Consent:data","Consent:consentor","Consent:actor","Condition:subject","Condition:evidence-detail","Condition:asserter","Composition:subject","Composition:entry","Composition:author","Composition:attester","CommunicationRequest:subject","CommunicationRequest:sender","CommunicationRequest:requester","CommunicationRequest:recipient","CommunicationRequest:patient","CommunicationRequest:based-on","Communication:subject","Communication:recipient","Communication:sender","Communication:patient","Communication:part-of","Communication:based-on","ClinicalImpression:subject","ClaimResponse:patient","Claim:payee","Claim:patient","ChargeItem:subject","ChargeItem:patient","ChargeItem:participant-actor","ChargeItem:enterer","CareTeam:subject","CareTeam:participant","CarePlan:performer","CarePlan:subject","BodySite:patient","Basic:subject","Basic:patient","Basic:author","AuditEvent:patient","AuditEvent:entity","AuditEvent:agent","AppointmentResponse:patient","AppointmentResponse:actor","Appointment:patient","Appointment:actor","AllergyIntolerance:recorder","AllergyIntolerance:asserter","AdverseEvent:subject","AdverseEvent:recorder","ActivityDefinition:successor","ActivityDefinition:predecessor","ActivityDefinition:depends-on","ActivityDefinition:derived-from","ActivityDefinition:composed-of","Account:subject","Account:patient"],je=n(1280),Ee=n(149),_e=Ee.a.get("mapper"),we=je.mappers[_e],Pe=we?new we:null,Ce=function(e){return Pe&&e&&(e=Pe.execute(e)),e};function Oe(e,t){t.push("Patient:_id");var n=[];return t.forEach((function(t){t=t.split(":");var a=e.request("".concat(t[0],"?").concat(t[1],"=").concat(e.patient.id),{flat:!0,pageLimit:0}).then((function(e){if(e.length>0)return e})).catch((function(e){console.log("failed to fetch ".concat(t)),console.error(e)}));n.push(a)})),Promise.all(n).then((function(e){return e.filter((function(e){return e})).flat()}))}function Ne(e,t,n){var a=t.join("&_revinclude=");return e.request("/Patient?_id=".concat(e.patient.id,"&_revinclude=").concat(a),{flat:!0}).then((function(e){return e})).catch((function(a){console.log("Reverse Include query failed, manually fetching resources instead."),console.error(a),n(e,t)}))}var ke=Object(a.createContext)({patient:{}}),xe=function(e){var t=e.client,n=e.children;return i.a.createElement(ke.Provider,{value:t},n)},Re=function(){return Object(a.useContext)(ke)},Se=n(128),De=n(139),Te=n.n(De);function Me(e){return fetch("./static/cql/".concat(e)).then((function(e){return e.text()}))}function Ae(e,t){return('define "'+t+'":\n\t').concat(e)}function qe(e,t){return e.concat("\n","\n",t)}function Le(e){return"transitions"in e&&e.transitions.length>1}var Ie=/.*;boundary=(Boundary.*);?.*/g,Be=/Content-Disposition: form-data; name="([^"]+)"/,ze=/(\{[^]*\})/,Ue=/include .* called (.*)/g,Fe=Ee.a.get("cqlToElmWebserviceUrl");var He=n(186),Ge=n(1281);function Ve(e,t,n){var a;a=n?new He.Library(t,new He.Repository(n)):new He.Library(t);var i=new He.Executor(a),r=new Ge.PatientSource.FHIRv400(e);return r.loadBundles(e),i.exec(r)}function We(e,t,n,a){for(var i=Object.values(a).filter((function(e){return e.onPath})).map((function(e){return e.node})),r=0,o=Object.entries(e.nodes);r<o.length;r++){var c=o[r],s=Object(u.a)(c,2),l=s[0],d=s[1];if(!i.includes(l))if("action"in d){if(t[l]&&t[l].length){var m=t[l][0];m.node=l,m.onPath=!1,m.resource=Ye(m,n),a[l]=Object(h.a)({},m)}}else{var p=!0,v=!1,f=void 0;try{for(var y,b=d.transitions[Symbol.iterator]();!(p=(y=b.next()).done);p=!0){var g=y.value;if(g.condition)if(t[g.condition.description]&&t[g.condition.description].length){var j=t[g.condition.description][0];j.node=l,j.onPath=!1,j.resource=Ye(j,n),a[l]=Object(h.a)({},j)}else{var E=ce(g.condition.description,n);if(E){var _={resourceType:"DocumentReference",status:E.status,id:E.id,node:l,onPath:!1,resource:E};a[l]=Object(h.a)({},_)}}}}catch(w){v=!0,f=w}finally{try{p||null==b.return||b.return()}finally{if(v)throw f}}}}return a}function Je(e,t){return e.node=t,e}function Qe(e,t,n){return(function(e,t){return t.some((function(t){if("DocumentReference"!==t.resourceType)return!1;var n=t.content[0].attachment.data;return!!n&&atob(n)==="".concat(e.label," - Advance")}))}(t,n)||function(e){return"completed"===e.status}(e))&&0!==t.transitions.length?[t.transitions[0].transition]:[]}function Xe(e,t,n,a){var i=e.nodes[n];if("action"in i){var r,o=t[n];if(null===(r=o)||void 0===r?void 0:r.length)return{nextNodes:Qe(o=o[0],i,a),documentation:Je(o,n),status:"status"in o?o.status:"unknown"};var c=ce(i.label,a);if(c){var s={resourceType:"DocumentReference",id:c.id?c.id:"unknown",status:"status"in c?c.status:"unknown",node:n,resource:c,onPath:!0};return{nextNodes:Qe(s,i,a),documentation:Je(s,n),status:s.status}}return null}return 1===i.transitions.length?{nextNodes:[i.transitions[0].transition],documentation:{node:n,onPath:!0},status:"completed"}:i.transitions.length>1?function(e,t,n,a){var i=[],r=[],o=!0,c=!1,s=void 0;try{for(var l,u=t.transitions[Symbol.iterator]();!(o=(l=u.next()).done);o=!0){var d=l.value;if(d.condition){var m,p=null;if(null===(m=e[d.condition.description])||void 0===m?void 0:m.length)p=e[d.condition.description][0];else{var v=ce(d.condition.description,a);v&&(p={resourceType:"DocumentReference",id:v.id?v.id:"unknown",status:v.status,node:n,resource:v,onPath:!0})}p&&(r.push(d.transition),i.push(p))}}}catch(f){c=!0,s=f}finally{try{o||null==u.return||u.return()}finally{if(c)throw s}}return r.length&&i.length?{nextNodes:r,documentation:Je(i[0],n),status:i[0].status}:null}(t,i,n,a):null}function Ye(e,t){var n=void 0;return"resourceType"in e&&t&&(n=t.find((function(t){return t.resourceType===e.resourceType&&t.id===e.id}))),n}function Ke(e,t,n){var a;return((null===(a=t.elm)||void 0===a?void 0:a.navigational)?et(e,t.elm.navigational):function(e){return Me(e.library).then((function(t){var n=t;for(var a in e.nodes){var i=e.nodes[a];if("cql"in i)n=qe(n,Ae(i.cql,a));else if(Le(i)){var r=!0,o=!1,c=void 0;try{for(var s,l=i.transitions[Symbol.iterator]();!(r=(s=l.next()).done);r=!0){var u=s.value.condition;if(u)n=qe(n,Ae(u.cql,u.description))}}catch(d){o=!0,c=d}finally{try{r||null==l.return||l.return()}finally{if(o)throw c}}}}return n}))}(t).then((function(t){return $e(e,t)}))).then((function(e){return function(e,t,n){for(var a={},i=["Start"],r=Xe(e,t,"Start",n);null!==r&&null!==r.documentation;){var o=r.documentation;if(o.onPath=!0,o.resource=Ye(r.documentation,n),a[r.documentation.node]=Object(h.a)({},o),0===r.nextNodes.length)break;if(1===r.nextNodes.length)i=r.nextNodes,r=Xe(e,t,r.nextNodes[0],n);else{i=[];var c=[],s=!0,l=!1,u=void 0;try{for(var d,m=r.nextNodes[Symbol.iterator]();!(s=(d=m.next()).done);s=!0){var p=d.value;ce(e.nodes[p].label,n)||t[p]&&t[p].length?c.push(p):i.push(p)}}catch(v){l=!0,u=v}finally{try{s||null==m.return||m.return()}finally{if(l)throw u}}if(0!==c.length)i=c;else if(0===i.length){i=r.nextNodes;break}r=Xe(e,t,c.length?c[0]:i[0],n)}}return{patientId:t.Patient.id.value,currentNodes:i,documentation:We(e,t,n,a)}}(t,e,n)}))}function Ze(e,t){var n;return((null===(n=t.elm)||void 0===n?void 0:n.preconditions)?et(e,t.elm.preconditions):function(e){return Me(e.library).then((function(t){var n=t,a=!0,i=!1,r=void 0;try{for(var o,c=e.preconditions[Symbol.iterator]();!(a=(o=c.next()).done);a=!0){var s=o.value;n=qe(n,Ae(s.cql,s.elementName))}}catch(l){i=!0,r=l}finally{try{a||null==c.return||c.return()}finally{if(i)throw r}}return n}))}(t).then((function(t){return $e(e,t)}))).then((function(e){return function(e,t){var n=[],a=0;return e.preconditions.forEach((function(e){var i=t[e.elementName];Array.isArray(i)&&(i=i[0]);var r="unknown",o=!1;i&&(r=i.value,o=i.match),o&&(a+=1);var c={elementName:e.elementName,expected:e.expected,actual:r,match:o};n.push(c)})),{pathwayName:e.name,matches:a,preconditionResultItems:n}}(t,e)}))}function $e(e,t){return function(e){var t=Ue.exec(e);return t?Me("".concat(t[1],".cql")).then((function(e){return new Promise((function(t,n){setTimeout((function(){t({FHIRHelpers:e})}),300)}))})):new Promise((function(e,t){e({})}))}(t).then((function(e){return Object.keys(e).length>0?function(e){var t=new FormData;return Object.keys(e.libraries).forEach((function(n,a){t.append("".concat(n),e.libraries[n])})),t.append("main",e.main),fetch(Fe,{method:"POST",body:t}).then((function(e){var t=e.headers.get("content-type"),n="";if(t){var a=Ie.exec(t);n=a?"--".concat(a[1]):""}var i={main:{},libraries:{}};return e.text().then((function(e){return e.split(n).reduce((function(e,t,n){var a=ze.exec(t);if(a){var i=Be.exec(t);i&&"main"===i[1]?e[i[1]]=JSON.parse(a[1]):i&&(e.libraries[i[1]]=JSON.parse(a[1]))}return e}),i)}))}))}({main:t,libraries:e}):function(e){return fetch(Fe,{method:"POST",headers:{"Content-Type":"application/cql",Accept:"application/elm+json"},body:e}).then((function(e){return e.json()}))}(t)})).then((function(t){return et(e,t)}))}function et(e,t){return new Promise((function(n,a){var i;i="main"in t?Ve(e,t.main,t.libraries):Ve(e,t);var r=Object.keys(i.patientResults);n(i.patientResults[r[0]])}))}var tt=["Pathway","Mcode","Patient","Condition","Observation","DiagnosticReport","MedicationRequest","AllergyIntolerance","CarePlan","Procedure","Encounter","Immunization"],nt=function(e,t){var n;return null!==(n=t.get(e))&&void 0!==n?n:[]},at=function(e){var t=e.recordSection,n=e.resources,r=Object(a.useState)(!1),o=Object(u.a)(r,2),c=o[0],s=o[1],l=c?m.g:m.e,p=["Patient","Pathway","Mcode"].includes(t)?"":"(".concat(n.length,")");return i.a.createElement("div",{className:Te.a.element},i.a.createElement("div",{className:Te.a.title,onClick:function(){return s(!c)}},i.a.createElement("div",null,t," ",p),i.a.createElement("div",{className:Te.a.expand},i.a.createElement(d.a,{icon:l}))),c&&i.a.createElement("div",{className:Te.a.visualizerContainer},i.a.createElement(it,{recordSection:t,resourcesByType:n})))},it=function(e){var t=e.recordSection,n=e.resourcesByType,a=D().patient;return"Pathway"===t?i.a.createElement(rt,null):"Mcode"===t?i.a.createElement(ot,null):"Patient"===t?i.a.createElement(Se.h,{patient:a}):"Condition"===t?i.a.createElement(Se.c,{rows:n}):"Observation"===t?i.a.createElement(Se.g,{rows:n}):"DiagnosticReport"===t?i.a.createElement(Se.j,{rows:n}):"MedicationRequest"===t?i.a.createElement(Se.f,{rows:n}):"AllergyIntolerance"===t?i.a.createElement(Se.a,{rows:n}):"CarePlan"===t?i.a.createElement(Se.b,{rows:n}):"Procedure"===t?i.a.createElement(Se.i,{rows:n}):"Encounter"===t?i.a.createElement(Se.d,{rows:n}):"Immunization"===t?i.a.createElement(Se.e,{rows:n}):i.a.createElement("div",null,"Unsupported Resource")},rt=function(){var e=ue().patientRecords,t=F().evaluatedPathway,n=Object(a.useState)(null),r=Object(u.a)(n,2),o=r[0],c=r[1];return Object(a.useEffect)((function(){var n={resourceType:"Bundle",type:"searchset",entry:e.map((function(e){return{resource:e}}))};t&&Ze(n,t.pathway).then((function(e){return c(e)}))}),[t,e]),i.a.createElement("table",null,i.a.createElement("tbody",null,null===o||void 0===o?void 0:o.preconditionResultItems.map((function(e){return i.a.createElement("tr",{key:e.elementName},i.a.createElement("td",null,e.elementName),i.a.createElement("td",null,e.actual))}))))},ot=function(){var e=ue().mcodeRecords,t=[];for(var n in e)t.push(n);return i.a.createElement("table",null,i.a.createElement("tbody",null,t.map((function(t){return i.a.createElement("tr",{key:t},i.a.createElement("td",null,t),i.a.createElement("td",null,e[t]?e[t]:"-"))}))))},ct=function(e){var t=e.headerElement,n=ue().patientRecords,r=Object(a.useRef)(null),o=Object(a.useState)(!1),c=Object(u.a)(o,2),s=c[0],l=c[1],p=function(e){var t=new Map;return e.forEach((function(e){var n,a=null!==(n=e.resourceType)&&void 0!==n?n:"";if(tt.includes(a)){var i=t.get(a);i?i.push(e):t.set(a,[e])}})),t}(n),v=function(){l(!s)};return Object(a.useEffect)((function(){(null===r||void 0===r?void 0:r.current)&&(null===t||void 0===t?void 0:t.current)&&(r.current.style.height=window.innerHeight-t.current.clientHeight+"px")}),[s,t]),s?i.a.createElement("div",{className:Te.a.record,ref:r},i.a.createElement("div",{className:Te.a.sidebar},tt.map((function(e){return i.a.createElement(at,{recordSection:e,resources:nt(e,p),key:e})}))),i.a.createElement("div",{className:Te.a.recordToggle,onClick:v},i.a.createElement(d.a,{icon:m.f}))):i.a.createElement("div",{className:Te.a.record},i.a.createElement("div",{className:Te.a.recordToggle,onClick:v},i.a.createElement(d.a,{icon:m.n})))},st=n(298),lt=n(512),ut=n.n(lt),dt=Ee.a.get("graphLayoutProvider","dagre");function mt(e,t){return"dagre"===dt?function(e,t){var n=Object.keys(e.nodes),a=new ut.a.graphlib.Graph;a.setGraph({}),a.setDefaultEdgeLabel((function(){return{}})),n.forEach((function(n){var i=e.nodes[n],r=t[n];r?a.setNode(n,{label:i.label,width:r.width,height:r.height}):a.setNode(n,{label:i.label,width:10*i.label.length,height:50}),i.transitions.forEach((function(e){var t=e.condition?{label:e.condition.description,width:25,height:20}:{};a.setEdge(n,e.transition,t)}))})),ut.a.layout(a);for(var i={},r=a.node("Start").x,o=0,c=n;o<c.length;o++){var s=c[o],l=a.node(s);i[s]={x:l.x-r-l.width/2,y:l.y-l.height/2}}var u={};return a.edges().forEach((function(e){var t=a.edge(e),n="".concat(e.v,", ").concat(e.w),i=t.label?{text:t.label,x:t.x-r,y:t.y}:null;u[n]={label:i,start:e.v,end:e.w,points:t.points.map((function(e){return{x:e.x-r,y:e.y}}))}})),{nodeCoordinates:i,edges:u}}(e,t):function(e){var t="Start",n=function(e){var n,a={};for(n in e.nodes)a[n]={label:n,rank:NaN,horizontalPosition:NaN,children:[],parents:[],canMove:!0};return Object.keys(e.nodes).forEach((function(t){e.nodes[t].transitions.forEach((function(e){a[t].children.includes(e.transition)||a[t].children.push(e.transition),a[e.transition].parents.includes(t)||a[e.transition].parents.push(t)}))})),a[t].rank=0,a}(e),a=[[t]],i=110,r=100,o=0;do{var c=!0,s=!1,l=void 0;try{for(var u,d=a[o][Symbol.iterator]();!(c=(u=d.next()).done);c=!0){var m=u.value;y(n[m],o+1)}}catch(g){s=!0,l=g}finally{try{c||null==d.return||d.return()}finally{if(s)throw l}}o++}while(a.length!==o);for(p(n[t],-50),o=1;o<a.length;o++)v(o);return{nodeCoordinates:function(){var e={};for(var t in n){var a=n[t];e[t]={x:a.horizontalPosition,y:a.rank*r}}return e}(),edges:{}};function p(e,t){if(isNaN(e.horizontalPosition)||e.canMove){e.horizontalPosition=t;for(var n=1;f(e);){var a=n%2===0?-1:1;e.horizontalPosition=t+a*Math.ceil(n/2)*i,n+=1}}}function v(e){var t=!0,r=!1,o=void 0;try{for(var c,s=function(){var e=c.value,t=n[e];if(!isNaN(t.horizontalPosition))return"continue";var a=t.parents.filter((function(e){return n[e].rank<t.rank}));if(1===a.length){var r=t.parents[0],o=n[r];if(o.children.length%2===1)p(n[o.children[Math.floor(o.children.length/2)]],o.horizontalPosition);!function(e){var t=e.children.filter((function(e){return isNaN(n[e].horizontalPosition)||n[e].canMove}));if(0!==t.length)if(1!==t.length){t.length%2===1&&t.splice(Math.ceil(t.length/2),1);for(var a=0;a<t.length/2;a++){var r=n[t[t.length/2-a-1]];p(r,e.horizontalPosition-(a+1)*i),r.canMove=!1,p(r=n[t[t.length/2+a]],e.horizontalPosition+(a+1)*i),r.canMove=!1}}else p(n[t[0]],e.horizontalPosition)}(o)}else{var s=a.map((function(e){return n[e].horizontalPosition})).reduce((function(e,t){return e+t}),0);p(t,s/a.length)}},l=a[e][Symbol.iterator]();!(t=(c=l.next()).done);t=!0)s()}catch(g){r=!0,o=g}finally{try{t||null==l.return||l.return()}finally{if(r)throw o}}}function f(e){var t=a[e.rank].map((function(e){return n[e]})),i=!0,r=!1,o=void 0;try{for(var c,s=t[Symbol.iterator]();!(i=(c=s.next()).done);i=!0){if(h(e,c.value))return!0}}catch(g){r=!0,o=g}finally{try{i||null==s.return||s.return()}finally{if(r)throw o}}return!1}function h(e,t){return!function(e,t){return e.label===t.label}(e,t)&&(!isNaN(e.rank)&&!isNaN(e.horizontalPosition)&&!isNaN(t.rank)&&!isNaN(t.horizontalPosition)&&e.rank===t.rank&&e.horizontalPosition===t.horizontalPosition)}function y(e,t){e.children.forEach((function(i){var r=n[i];r.rank<e.rank?(a[r.rank].splice(a[r.rank].indexOf(i),1),b(i,t),y(r,t+1)):isNaN(r.rank)&&b(i,t)}))}function b(e,t){try{a[t].push(e)}catch(g){a[t]=[e]}finally{n[e].rank=t}}}(e)}var pt=n(106),vt=n.n(pt),ft=n(137),ht=n.n(ft),yt=n(174),bt=n.n(yt),gt=n(1946),jt=n(1282),Et=n.n(jt),_t=function(e){var t=e.Content,n=e.Trigger,a=e.popupPosition,r=e.open,o=e.setOpen,c=e.className;return i.a.createElement(gt.a,{content:t,position:a||"bottom right",className:"".concat(Et.a.pathwayPopup," ").concat(c),on:"click",open:r,onOpen:function(){o&&o(!0)},onClose:function(){o&&o(!1)},pinned:!0,trigger:n})},wt=n(188),Pt=n.n(wt),Ct=function(e){var t=e.type,n=e.onClick;return i.a.createElement(de.a,{onClick:n,variant:"decline"===t?"text":"contained",color:"decline"===t?"secondary":"primary"},t[0].toUpperCase()+t.slice(1))},Ot=function(e){var t=e.type,n=e.onClick;return i.a.createElement("div",{className:"".concat("accept"===t?Pt.a.accept:Pt.a.decline," ").concat(Pt.a.smallActionButton),onClick:n,"data-testid":t},i.a.createElement(d.a,{icon:"accept"===t?m.c:m.v}))},Nt=function(e){var t=e.type,n=e.onClick;return i.a.createElement("div",{className:"".concat("accept"===t?Pt.a.accept:Pt.a.decline," ").concat(Pt.a.mediumActionButton),onClick:n,"data-testid":t},i.a.createElement(d.a,{icon:"accept"===t?m.c:m.v}),{accept:"Submit",decline:"Cancel"}[t])},kt=function(e){var t=e.type,n=e.size,a=e.onClick;switch(n){case"small":return i.a.createElement(Ot,{type:t,onClick:a});case"large":return i.a.createElement(Ct,{type:t,onClick:a});case"medium":return i.a.createElement(Nt,{type:t,onClick:a})}},xt=function(e){var t=e.values,n=e.setOpen,r=D().patient,o=Re(),c=ue(),s=c.patientRecords,d=c.setPatientRecords,m=Object(a.useState)(!1),p=Object(u.a)(m,2),v=p[0],f=p[1],h=Object(a.useState)(""),y=Object(u.a)(h,2),b=y[0],g=y[1],j=J().note;return i.a.createElement("div",null,i.a.createElement("div",{className:bt.a.popupContent},"Select Value:",i.a.createElement("div",null,t.map((function(e){return i.a.createElement("div",{key:e,className:bt.a.popupChoice+" "+(b===e?bt.a.selected:""),onClick:function(){v&&b===e?(f(!1),g("")):(f(!0),g(e))}},e)})))),i.a.createElement("div",{className:bt.a.footer},i.a.createElement(kt,{size:"small",type:"decline",onClick:function(){return n(!1)}}),v&&i.a.createElement(kt,{size:"small",type:"accept",onClick:function(){if(n(!1),j){var e,t=te(ne(j,s,"completed",b),b,r);d([].concat(Object(l.a)(s),[t])),null===o||void 0===o||null===(e=o.create)||void 0===e||e.call(o,t)}}})))},Rt=function(e){var t=e.values,n=Object(a.useState)(!1),r=Object(u.a)(n,2),o=r[0],c=r[1];return i.a.createElement(_t,{Content:i.a.createElement(xt,{values:t,setOpen:c}),className:bt.a.missingDataPopup,Trigger:i.a.createElement("div",{className:bt.a.popupTrigger},"missing data",i.a.createElement(d.a,{icon:m.i,className:bt.a.externalLink})),open:o,setOpen:c})},St=n(119),Dt=n.n(St),Tt=n(140),Mt=n.n(Tt),At=function(e){var t=e.sectionTitle,n=e.value;return i.a.createElement("div",{className:Mt.a.field},i.a.createElement("b",null,t,": "),i.a.createElement("span",null,n))},qt=function(e){var t=e.icon,n=e.notes;return i.a.createElement("div",{className:Mt.a.sectionContainer},i.a.createElement("div",{className:Mt.a.sectionIconContainer},i.a.createElement(d.a,{icon:t,className:Mt.a.icon})),i.a.createElement("div",{className:Mt.a.notesField},i.a.createElement("b",null,"Physician Notes: "),i.a.createElement("div",null,n)))},Lt=function(e){var t=e.icon,n=e.fields;return i.a.createElement("div",{className:Mt.a.sectionContainer},i.a.createElement("div",{className:Mt.a.sectionIconContainer},i.a.createElement(d.a,{icon:t,className:Mt.a.icon})),i.a.createElement("div",{className:Mt.a.fieldContainer},n.filter((function(e){return e.name})).map((function(e){return i.a.createElement(At,{sectionTitle:e.name,value:e.value,key:Z.a.generate()})}))))},It=n(243),Bt=n.n(It),zt=function(e){var t,n,a,r,o,c=e.onConfirm,s=e.onDecline,l=J().note,u=ue().mcodeRecords,d=[{name:"Date",value:null===l||void 0===l?void 0:l.date},{name:"Patient",value:null===l||void 0===l?void 0:l.patient},{name:"Date of Birth",value:null===l||void 0===l?void 0:l.birthdate},{name:"Physician",value:null===l||void 0===l?void 0:l.physician}],p=[{name:"Primary Cancer",value:null!==(t=u["Primary Cancer"])&&void 0!==t?t:"Unknown"},{name:"Laterality",value:null!==(n=u.Laterality)&&void 0!==n?n:"Unknown"},{name:"Clinical TNM",value:oe(u)},{name:"Estrogen Receptor",value:null!==(a=u["Estrogen Receptor"])&&void 0!==a?a:"Unknown"},{name:"Progesterone Receptor",value:null!==(r=u["Progesterone Receptor"])&&void 0!==r?r:"Unknown"},{name:"HER2 Receptor",value:null!==(o=u["HER2 Receptor"])&&void 0!==o?o:"Unknown"}],v=[{name:"Pathway Selected",value:null===l||void 0===l?void 0:l.pathway},{name:"Recommendation",value:null===l||void 0===l?void 0:l.node},{name:"Pathway Status",value:null===l||void 0===l?void 0:l.status}];return i.a.createElement("div",{className:Bt.a.reportModal},i.a.createElement("h1",null,"Pathway Report"),i.a.createElement("div",{className:Bt.a.sectionContainer},i.a.createElement(Lt,{icon:m.x,fields:d}),i.a.createElement(Lt,{icon:m.n,fields:p}),i.a.createElement(Lt,{icon:m.r,fields:v}),(null===l||void 0===l?void 0:l.notes)&&i.a.createElement(qt,{icon:m.s,notes:null===l||void 0===l?void 0:l.notes})),i.a.createElement("div",{className:Bt.a.confirmationSection},i.a.createElement("i",null,"The above note will be written into the EHR and any procedure requests will be submitted."),i.a.createElement("div",{className:Bt.a.confirmationButtonGroup},i.a.createElement(kt,{size:"medium",type:"accept",onClick:c}),i.a.createElement(kt,{size:"medium",type:"decline",onClick:s}))))};function Ut(e){var t=e.action;return!!t&&t.length>0}var Ft=Object(a.memo)((function(e){var t,n=e.actionNode,r=e.isActionable,o=e.isCurrentNode,c=e.isAction,s=e.documentation,d=e.isAccepted,m=J(),p=m.note,v=m.setNote,f=Object(a.useState)(!1),y=Object(u.a)(f,2),b=y[0],g=y[1],j=ue(),E=j.patientRecords,_=j.setPatientRecords,w=Re(),P=D().patient;p&&(p.node=n.label);var C=function(e){var t=Object(l.a)(E);if(p){var a,i,r=te(ne(p,E,p.status,null!==(a=null===p||void 0===p?void 0:p.notes)&&void 0!==a?a:"",n),n.label,P);t.push(r),null===w||void 0===w||null===(i=w.create)||void 0===i||i.call(w,r)}if("Accepted"===(null===p||void 0===p?void 0:p.status)&&e&&e.length>0){var o,c=function(e,t){var n=e.resourceType,a={id:Object(Y.a)(),resourceType:n,intent:"order",subject:{reference:"Patient/".concat(t)},status:"active",authoredOn:(new Date).toISOString(),meta:{lastUpdated:(new Date).toISOString()}};switch(n){case"ServiceRequest":var i=e.code;return Object(h.a)({},a,{code:i});case"MedicationRequest":var r=e.medicationCodeableConcept;return Object(h.a)({},a,{medicationCodeableConcept:r});case"CarePlan":var o=e.title;return Object(h.a)({},a,{title:o});default:throw Error("Translation for ".concat(n," not implemented."))}}(e[0].resource,P.id);t.push(c),null===w||void 0===w||null===(o=w.create)||void 0===o||o.call(w,c)}_(t),g(!1)};return i.a.createElement(i.a.Fragment,null,i.a.createElement(Vt,{isAction:c,isActionable:r,isCurrentNode:o,actionNode:n,documentation:s,setComments:function(e){v((function(t){return Object(h.a)({},t,{notes:e})}))},comments:null!==(t=null===p||void 0===p?void 0:p.notes)&&void 0!==t?t:"",onAccept:function(){v((function(e){return Object(h.a)({},e,{status:"Accepted"})})),g(!0)},onDecline:function(){v((function(e){return Object(h.a)({},e,{status:"Declined"})})),g(!0)},isAccepted:d,onAdvance:function(){var e,t=ee("".concat(n.label," - Advance"),P);null===w||void 0===w||null===(e=w.create)||void 0===e||e.call(w,t),_([].concat(Object(l.a)(E),[t]))}}),b&&i.a.createElement(zt,{onConfirm:function(){return C(n.action)},onDecline:function(){return g(!1)}}))})),Ht=function(e){var t=e.title,n=e.description;return i.a.createElement("tr",null,i.a.createElement("td",{className:Dt.a.descTitle},t),i.a.createElement("td",{className:Dt.a.desc},n))},Gt=function(e){var t,n,a=e.documentation,r=e.isAccepted;if(!(null===a||void 0===a?void 0:a.resource))return null;var o=a.status,c=null===(t=a.resource)||void 0===t?void 0:null===(n=t.meta)||void 0===n?void 0:n.lastUpdated;if(c){var s=new Date(c).toLocaleString("en-us"),l="";return l=r?o.charAt(0).toUpperCase()+o.slice(1):null===r?"Status":"Declined",i.a.createElement(Ht,{key:"Status",title:l,description:r?s:s.concat(" by Dr. Example")})}return null};var Vt=Object(a.memo)((function(e){var t,n,a=e.documentation,r=e.actionNode,o=e.isAction,c=e.isActionable,s=e.isCurrentNode,l=e.comments,u=e.setComments,p=e.onAccept,v=e.onDecline,f=e.isAccepted,h=e.onAdvance,y=ue().patientRecords,b=o&&function(e,t,n){var a,r,o=e.action[0].resource,c=void 0!==o.medicationCodeableConcept?null===o||void 0===o?void 0:null===(a=o.medicationCodeableConcept)||void 0===a?void 0:a.coding:null===o||void 0===o?void 0:null===(r=o.code)||void 0===r?void 0:r.coding,s=[i.a.createElement(Ht,{key:"Description",title:"Description",description:e.action[0].description}),i.a.createElement(Ht,{key:"Type",title:"Type",description:o.resourceType})];if(c){var l=[i.a.createElement(Ht,{key:"System",title:"System",description:i.a.createElement(i.a.Fragment,null,c&&c[0].system,i.a.createElement("a",{href:c&&c[0].system,target:"_blank",rel:"noopener noreferrer"},i.a.createElement(d.a,{icon:m.j,className:Dt.a.externalLink})))}),i.a.createElement(Ht,{key:"Code",title:"Code",description:c&&c[0].code}),i.a.createElement(Ht,{key:"Display",title:"Display",description:c&&c[0].display})];s.push.apply(s,l)}if(null===t||void 0===t?void 0:t.resource)switch(t.resourceType){case"Procedure":var u=t.resource,p=u.performedPeriod&&u.performedPeriod.start||u.performedDateTime,v=u.performedPeriod&&u.performedPeriod.end;p&&s.push(i.a.createElement(Ht,{key:"Start",title:"Start",description:new Date(p).toLocaleString("en-us")})),v&&s.push(i.a.createElement(Ht,{key:"End",title:"End",description:new Date(v).toLocaleString("en-us")}));break;case"CarePlan":var f=t.resource.title;f&&s.push(i.a.createElement(Ht,{key:"Title",title:"Title",description:f}))}return s}(r,a),g=!Ut(t=r)&&t.transitions.length>1&&function(e,t,n){var a=[];if(null===e||void 0===e?void 0:e.resource)switch(e.resourceType){case"Observation":var r,o=e.resource,c=null===(r=o.valueCodeableConcept)||void 0===r?void 0:r.coding;c&&a.push(i.a.createElement(Ht,{key:"ValueSystem",title:"System",description:i.a.createElement(i.a.Fragment,null,c[0].system,i.a.createElement("a",{href:c[0].system,target:"_blank",rel:"noopener noreferrer"},i.a.createElement(d.a,{icon:m.j,className:Dt.a.externalLink})))}),i.a.createElement(Ht,{key:"ValueCode",title:"Code",description:c[0].code}),i.a.createElement(Ht,{key:"ValueDisplay",title:"Display",description:c[0].display}));var s=o.effectiveDateTime;s&&a.push(i.a.createElement(Ht,{key:"Date",title:"Date",description:new Date(s).toLocaleString("en-us")}));break;case"DocumentReference":var l=e.resource,u=l.subject;u&&a.push(i.a.createElement(Ht,{key:"subject",title:"Subject",description:u.reference}));var p=l.identifier,v=null===p||void 0===p?void 0:p.find((function(e){return"pathways.documentreference"===e.system}));if(v){var f=atob(v.value);a.push(i.a.createElement(Ht,{key:"value",title:"Value",description:f}))}else{var h=l.content[0].attachment.data;h&&a.push(i.a.createElement(Ht,{key:"note",title:"Note",description:atob(h)}))}break;default:a.push(i.a.createElement(Ht,{key:"error",title:"Error",description:"Unsupported Resource Type"}))}else{var y=t.transitions.map((function(e){var t,n=null===(t=e.condition)||void 0===t?void 0:t.description;return n||""})).filter((function(e,t,n){return n.indexOf(e)===t}));a.push(i.a.createElement(Ht,{key:"value",title:"Value",description:i.a.createElement(Rt,{values:y})}))}return a}(a,r),j="The patient and I discussed the treatment plan, risks, benefits and alternatives.  The patient expressed understanding and wants to proceed.",E=ce(r.label,y);if(E){var _,w=null===(_=E.content[0].attachment)||void 0===_?void 0:_.data;w&&(n=(n=atob(w)).slice(n.indexOf("Notes: ")+7))}return i.a.createElement("div",{className:ht.a.expandedNode},i.a.createElement("table",{className:Dt.a.infoTable},i.a.createElement("tbody",null,i.a.createElement(Gt,{documentation:a,isAccepted:f}),b||g,!c&&n&&/\S/.test(n)&&i.a.createElement(Ht,{key:"Comments",title:"Comments",description:n}))),r.transitions.length>0&&!c&&o&&s&&i.a.createElement(de.a,{className:"".concat(ht.a.button," ").concat(Dt.a.button),variant:"contained",color:"primary",onClick:h},"Advance"),c&&o&&i.a.createElement("form",{className:Dt.a.commentsForm},i.a.createElement("div",null,i.a.createElement("label",null,"Comments:"),i.a.createElement(de.a,{className:"".concat(ht.a.button," ").concat(Dt.a.button),onClick:function(e){e.preventDefault(),l.includes(j)||u(l+j)},variant:"contained",color:"primary"},"Use Default Text")),i.a.createElement("textarea",{className:Dt.a.comments,value:l,onChange:function(e){return u(e.target.value)}}),i.a.createElement("div",{className:Dt.a.footer},i.a.createElement(kt,{type:"accept",size:"large",onClick:p})),i.a.createElement("div",{className:Dt.a.footer},i.a.createElement(kt,{type:"decline",size:"large",onClick:v}))))})),Wt=Ft,Jt=Object(k.a)((function(e){return{"not-on-patient-path":{backgroundColor:e.palette.background.default,color:e.palette.text.primary},"child-not-on-patient-path":{borderColor:e.palette.background.default}}}),{name:"Node"}),Qt=Object(a.memo)(Object(a.forwardRef)((function(e,t){var n=e.pathwayNode,a=e.documentation,r=e.isOnPatientPath,o=e.isCurrentNode,c=e.xCoordinate,s=e.yCoordinate,l=e.expanded,u=void 0!==l&&l,d=e.onClickHandler,m=n.label,p={top:s,left:c},v=Jt(),f=r?vt.a.onPatientPath:Object(x.a)(vt.a.notOnPatientPath,v["not-on-patient-path"]),h=o&&!a,y=[vt.a.node,f],b="";u&&y.push(ht.a.expanded),h?(y.push(vt.a.actionable),b=vt.a.childActionable):b=r?vt.a.childOnPatientPath:Object(x.a)(vt.a.childNotOnPatientPath,v["child-not-on-patient-path"]);var g=Ut(n),j=r&&g&&!h?"DocumentReference"!==(null===a||void 0===a?void 0:a.resourceType):null;!1===j&&(y.push(vt.a.declined),u&&(b=vt.a.childDeclined));var E=null;return"action"in n?E=r?j:!(!g||!a)||null:!o&&a&&(E=!0),i.a.createElement("div",{className:y.join(" "),style:p,ref:t},i.a.createElement("div",{className:"".concat(ht.a.nodeTitle," ").concat(d&&ht.a.clickable),onClick:d},i.a.createElement("div",{className:ht.a.iconAndLabel},i.a.createElement(Xt,{pathwayNode:n,isAction:g}),m),i.a.createElement(Yt,{status:E})),u&&i.a.createElement("div",{className:"".concat(vt.a.expandedNode," ").concat(b)},i.a.createElement(Wt,{actionNode:n,isActionable:h,isAction:g,documentation:a,isAccepted:j,isCurrentNode:o})))}))),Xt=function(e){var t=e.pathwayNode,n=e.isAction,a=m.l;if("Start"===t.label&&(a=m.o),n){var r=t;if(r.action.length>0){var o=r.action[0].resource.resourceType;"MedicationRequest"===o?a=m.q:"ServiceRequest"===o?a=m.t:"CarePlan"===o&&(a=m.a)}}return i.a.createElement(d.a,{icon:a,className:vt.a.icon})},Yt=function(e){var t=e.status;if(null===t)return null;var n=t?m.d:m.w;return i.a.createElement(d.a,{icon:n,className:vt.a.statusIcon})},Kt=Qt,Zt=n(305),$t=n.n(Zt),en=function(e){var t=e.points,n=e.arrowheadId,a=e.widthOffset,r=t.map((function(e){return{x:e.x+a,y:e.y}})),o=r.length;r[o-1].y-=17.5;var c,s="M ".concat(r[0].x," ").concat(r[0].y," ");return c=o%3,s=r.reduce((function(e,t,n,a){return n%3!==c?e:"".concat(e," C ").concat(t.x," ").concat(t.y," ").concat(a[n+1].x," ").concat(a[n+1].y," ").concat(a[n+2].x,"\n        ").concat(a[n+2].y)}),s),i.a.createElement("path",{d:s,fill:"transparent",markerEnd:"url(#".concat(n,")")})},tn=function(e){var t=e.edge,n=e.edgeName,a=e.isOnPatientPath,r=e.widthOffset,o=a?$t.a.arrowOnPatientPath:$t.a.arrow,c=n.replace(" ",""),s="arrowhead-".concat(c),l=t.label;return i.a.createElement("svg",{className:o},i.a.createElement(en,{points:t.points,arrowheadId:s,widthOffset:r}),l?i.a.createElement("text",{x:l.x+r,y:l.y},l.text):null,i.a.createElement("defs",null,i.a.createElement("marker",{id:s,className:$t.a.arrowhead,markerWidth:"10",markerHeight:"7",refX:"0",refY:"3.5",orient:"auto"},i.a.createElement("polygon",{points:"0 0, 10 3.5, 0 7"}))))},nn=n(1291),an=n.n(nn),rn=n(1292),on=n.n(rn),cn=function(e){return Object.values(e.documentation).filter((function(e){return e.onPath})).map((function(e){return e.node}))},sn=function(e,t){var n=cn(e),a=n.indexOf(t.start),i=n.indexOf(t.end);return-1!==a&&-1!==i&&a+1===i||!(a!==n.length-1||!e.currentNodes.includes(t.end))},ln=Object(a.memo)((function(e){var t,n,r,o=e.evaluatedPathway,c=e.interactive,s=void 0===c||c,l=e.expandCurrentNode,d=void 0===l||l,m=F();if(!o){if(!m.evaluatedPathway)return i.a.createElement("div",null,"No Pathway Loaded");o=m.evaluatedPathway}var p=ue(),v=p.patientRecords,f=o.pathway,y=Object(a.useRef)(null),b=Object(a.useRef)({}),g=Object(a.useState)(null!==(t=null===y||void 0===y?void 0:null===(n=y.current)||void 0===n?void 0:null===(r=n.parentElement)||void 0===r?void 0:r.clientWidth)&&void 0!==t?t:0),j=Object(u.a)(g,2),E=j[0],_=j[1],w=Object(a.useCallback)((function(e){p.setEvaluatePath(!1),m.updateEvaluatedPathways({pathway:f,pathwayResults:e})}),[f,m,p]),P=Object(a.useCallback)((function(){var e={};return(null===b||void 0===b?void 0:b.current)&&Object.keys(b.current).forEach((function(t){var n=b.current[t],a=n.clientWidth,i=Array.from(n.children).reduce((function(e,t){return e+t.clientHeight}),0);e[t]={width:a,height:i}})),mt(f,e)}),[f]),C=Object(a.useState)(P()),O=Object(u.a)(C,2),N=O[0],k=O[1],x=N.nodeCoordinates,R=N.edges,S=Object(a.useMemo)((function(){return void 0!==x?Object.values(x).map((function(e){return e.y})).reduce((function(e,t){return Math.max(e,t)})):0}),[x]),D=void 0!==x?Object.values(x).map((function(e){return e.x+E/2})).reduce((function(e,t){return Math.min(e,t)})):0;if(D<0){var T=-1*D;Object.keys(x).forEach((function(e){x[e].x+=T})),Object.keys(R).forEach((function(e){var t=R[e];t.points.forEach((function(e){return e.x+=T})),t.label&&(t.label.x+=T)}))}var M=Object.keys(N).toString(),A=Object(a.useMemo)((function(){return M.split(",").reduce((function(e,t){return e[t]=!1,e}),{})}),[M]),q=Object(a.useState)(A),L=Object(u.a)(q,2),I=L[0],B=L[1],z=Object(a.useCallback)((function(e,t){B((function(n){return Object(h.a)({},n,Object(st.a)({},e,null!==t&&void 0!==t?t:!n[e]))}))}),[]);Object(a.useEffect)((function(){var e,t=!1;if(v.length>0&&(!(null===(e=o)||void 0===e?void 0:e.pathwayResults)||p.evaluatePath))return Ke({resourceType:"Bundle",type:"searchset",entry:v.map((function(e){return{resource:e}}))},f,v).then((function(e){t||w(e)})),function(){t=!0}}),[f,v,o,w,p]),Object(a.useEffect)((function(){var e;if(null===(e=o)||void 0===e?void 0:e.pathwayResults){var t=!0,n=!1,a=void 0;try{for(var i,r=o.pathwayResults.currentNodes[Symbol.iterator]();!(t=(i=r.next()).done);t=!0){var c=i.value;d&&c&&z(c,!0)}}catch(s){n=!0,a=s}finally{try{t||null==r.return||r.return()}finally{if(n)throw a}}}}),[d,o,z]),Object(a.useEffect)((function(){var e;(null===(e=y.current)||void 0===e?void 0:e.parentElement)&&new on.a(y.current.parentElement,(function(){var e,t,n;_(null!==(e=null===(t=y.current)||void 0===t?void 0:null===(n=t.parentElement)||void 0===n?void 0:n.clientWidth)&&void 0!==e?e:0),k(P())}))}),[P]),Object(a.useEffect)((function(){k(P())}),[I,P]);var U=void 0!==R?Object.values(R).map((function(e){return e.label})).map((function(e){return e?e.x+10*e.text.length+E/2:0})).reduce((function(e,t){return Math.max(e,t)}),0):E,H=o.pathwayResults?o.pathwayResults.documentation:{};return i.a.createElement(un,{graphElement:y,interactive:s,maxHeight:S,nodeCoordinates:x,documentation:H,edges:R,evaluatedPathway:o,nodeRefs:b,parentWidth:E,maxWidth:U,pathway:f,expanded:I,setExpanded:z})})),un=Object(a.memo)((function(e){var t=e.graphElement,n=e.interactive,r=e.maxHeight,o=e.nodeCoordinates,c=e.documentation,s=e.edges,l=e.evaluatedPathway,u=e.nodeRefs,d=e.parentWidth,m=e.maxWidth,p=e.pathway,v=e.expanded,f=e.setExpanded;return i.a.createElement("div",{ref:t,id:"graph-root",className:an.a.root,style:{height:n?r+150:"inherit",width:m+"px",position:"relative",marginRight:"5px"}},void 0!==o?Object.keys(o).map((function(e){var t=c[e],r=Object(a.useCallback)((function(){return n?f(e):void 0}),[e]);return i.a.createElement(W,{date:new Date(Date.now()),key:e},i.a.createElement(Kt,{key:e,documentation:t,ref:function(t){u.current[e]=t},pathwayNode:p.nodes[e],isOnPatientPath:!!l.pathwayResults&&(cn(l.pathwayResults).includes(e)||l.pathwayResults.currentNodes.includes(e)),isCurrentNode:!!l.pathwayResults&&l.pathwayResults.currentNodes.includes(e),xCoordinate:o[e].x+d/2,yCoordinate:o[e].y,expanded:v[e],onClickHandler:r}))})):[],i.a.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",style:{width:m+5,height:r,zIndex:1,top:0,left:0,overflow:"visible"}},void 0!==s?Object.keys(s).map((function(e){var t=s[e];return i.a.createElement(tn,{key:e,edge:t,edgeName:e,isOnPatientPath:!!l.pathwayResults&&sn(l.pathwayResults,t),widthOffset:d/2})})):[]))})),dn=ln,mn=n(76),pn=n.n(mn),vn=Object(k.a)((function(e){return{"pathway-element":{backgroundColor:e.palette.background.default},"assigned-pathway-element":{backgroundColor:e.palette.primary.main},title:{color:e.palette.text.primary},"assigned-title":{color:e.palette.common.white}}}),{name:"PathwaysList"}),fn=function(e){var t=e.evaluatedPathway,n=e.preconditions,r=e.callback,o=e.assigned,c=vn(),s=t.pathway,l=F(),p=l.setEvaluatedPathway,v=l.assignPathway,f=l.unassignPathway,h=Object(a.useState)(!1),y=Object(u.a)(h,2),b=y[0],g=y[1],j=b?m.g:m.e;var E=Object(x.a)(o&&pn.a.assignedPathwayElement,o&&c["assigned-pathway-element"],!o&&pn.a.pathwayElement,!o&&c["pathway-element"]),_=Object(x.a)(pn.a.title,o&&c["assigned-title"],!o&&c.title);return i.a.createElement("div",{className:E,role:"list",key:s.name},i.a.createElement("div",{className:_,role:"listitem",onClick:function(e){p(t,!0),g(!b)}},i.a.createElement("div",null,s.name),o&&i.a.createElement(d.a,{icon:m.d}),i.a.createElement("div",{className:pn.a.expand},i.a.createElement(d.a,{icon:j})),i.a.createElement("div",{className:pn.a.numElements},null===n||void 0===n?void 0:n.matches)),b&&i.a.createElement("div",{className:pn.a.infoContainer},i.a.createElement("div",{className:pn.a.details},i.a.createElement("p",null,s.description),i.a.createElement("table",null,i.a.createElement("tbody",null,i.a.createElement("tr",null,i.a.createElement("th",null),i.a.createElement("th",null,"mCODE elements"),i.a.createElement("th",null,"patient elements")),null===n||void 0===n?void 0:n.preconditionResultItems.map((function(e){return i.a.createElement("tr",{key:e.elementName},i.a.createElement("td",null,e.elementName),i.a.createElement("td",null,e.expected),i.a.createElement("td",{className:e.match?pn.a.matchingElement:void 0},e.actual))})))),i.a.createElement(de.a,{onClick:function(){o?f(s.name):v(s.name)},variant:"contained",color:o?"secondary":"primary",startIcon:i.a.createElement(d.a,{icon:o?m.w:m.d})},o?"Unassign":"Assign"),i.a.createElement(de.a,{onClick:function(){r(t)},variant:"contained",color:"primary",startIcon:i.a.createElement(d.a,{icon:m.k})},"View")),i.a.createElement("div",{className:pn.a.pathway},i.a.createElement("div",{style:{height:"100%",overflow:"scroll"}},i.a.createElement(dn,{evaluatedPathway:t,interactive:!1,expandCurrentNode:!1})),i.a.createElement("div",{className:pn.a.controls},i.a.createElement(d.a,{icon:m.o}),i.a.createElement(d.a,{icon:m.p}),i.a.createElement(d.a,{icon:m.m})))))},hn=function(e){var t=e.evaluatedPathways,n=e.callback,r=e.service,o=e.headerElement,c=ue().patientRecords,s=Object(a.useState)(null),l=Object(u.a)(s,2),p=l[0],v=l[1];if(!p&&t.length>0&&c&&c.length>0){var f={resourceType:"Bundle",type:"searchset",entry:c.map((function(e){return{resource:e}}))},h=t.map((function(e){return Ze(f,e.pathway)}));Promise.all(h).then((function(e){v(e.sort((function(e,t){return t.matches-e.matches})))}))}var y=function(e,t){var n=e.filter((function(e){return"CarePlan"===e.resourceType})).filter((function(e){return"active"===e.status})).map((function(e){return e.title}));return t.map((function(e){return e.pathway.name})).filter((function(e){return n.includes(e)}))}(c,t),b={height:"100%"};return(null===o||void 0===o?void 0:o.current)&&(b.height=window.innerHeight-o.current.clientHeight+"px"),i.a.createElement("div",{className:pn.a.pathways_list,style:b},"loading"===r.status?i.a.createElement("div",null,"Loading..."):"loaded"===r.status?i.a.createElement("div",{className:pn.a.container},i.a.createElement("div",{className:pn.a.pathwayListHeaderContainer},i.a.createElement("div",{className:pn.a.header_title},i.a.createElement("div",{className:pn.a.header_title__header},"Explore Pathways"),i.a.createElement("div",{className:pn.a.header_title__note},"Select pathway below to view details")),i.a.createElement("div",{className:pn.a.matchedElementsLabel},i.a.createElement("i",null,"mCODE",i.a.createElement("br",null),"elements",i.a.createElement("br",null),"matched"),i.a.createElement(d.a,{icon:m.b}))),0!==(null===p||void 0===p?void 0:p.length)&&i.a.createElement("div",null,p?p.map((function(e){var a=t.find((function(t){return t.pathway.name===e.pathwayName}));if(a){var r=a.pathway.name;return i.a.createElement(fn,{evaluatedPathway:a,callback:n,preconditions:e,assigned:y.includes(r),key:r})}return i.a.createElement("div",null,"An error occured evaluating the pathway preconditions. Please try again.")})):i.a.createElement("div",null,"Loading Pathways..."))):i.a.createElement("div",null,"ERROR"))};var yn=function(e){var t=Object(a.useState)({status:"loading"}),n=Object(u.a)(t,2),i=n[0],r=n[1];return Object(a.useEffect)((function(){(function(e){return fetch(e,{headers:{Accept:"application/json"}})})(e).then((function(e){return e.json()})).then((function(t){return t.map((function(t){return function(e,t){return fetch(e,t).then((function(e){return e.json()}))}(e+"/"+t)}))})).then((function(e){return Promise.all(e)})).then((function(e){return r({status:"loaded",payload:e})})).catch((function(e){return r({status:"error",error:e})}))}),[e]),i},bn=n(1293),gn=n.n(bn),jn=n(184),En=n.n(jn),_n=n(85),wn=n(185),Pn=function(){function e(){Object(_n.a)(this,e),this.patient={}}return Object(wn.a)(e,[{key:"create",value:function(){return En.a.async((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("Mocked create"),e.abrupt("return",Promise.resolve({}));case 2:case"end":return e.stop()}}))}},{key:"delete",value:function(){return En.a.async((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("Mocked delete"),e.abrupt("return",Promise.resolve({}));case 2:case"end":return e.stop()}}))}}]),e}(),Cn=n(517),On=n.n(Cn),Nn=function(e){var t=e.headerElement,n=e.graphContainerElement;return i.a.createElement("div",{className:On.a.display},i.a.createElement(ct,{headerElement:t}),i.a.createElement("div",{ref:n,className:On.a.graph},i.a.createElement(dn,{expandCurrentNode:!0})))},kn=function(e){var t,n=e.demoId,r=Object(a.useState)(null),o=Object(u.a)(r,2),c=o[0],s=o[1],d=Object(a.useState)([]),m=Object(u.a)(d,2),p=m[0],v=m[1],f=Object(a.useState)({}),h=Object(u.a)(f,2),y=h[0],b=h[1],g=Object(a.useState)(null),j=Object(u.a)(g,2),E=j[0],_=j[1],w=Object(a.useState)(!0),C=Object(u.a)(w,2),O=C[0],k=C[1],x=Object(a.useState)(!1),R=Object(u.a)(x,2),D=R[0],T=R[1],M=Object(a.useState)([]),A=Object(u.a)(M,2),q=A[0],L=A[1],I=Object(a.useState)(null),B=Object(u.a)(I,2),z=B[0],F=B[1],H=Object(a.useState)(""),V=Object(u.a)(H,2),W=V[0],J=V[1],Q=Object(a.useRef)(null),Y=Object(a.useRef)(null),K=Object(a.useCallback)((function(e){v(e),T(!0)}),[]),ee=Object(a.useCallback)((function(e){var t={resourceType:"Bundle",type:"searchset",entry:e.map((function(e){return{resource:e}}))};Me("elm/mCODE.elm.json").then((function(e){var n,a,i,r,o,c,s,l,u=JSON.parse(e),d=Ve(t,u),m=Object.keys(d.patientResults),p=d.patientResults[m[0]],v={"Primary Cancer":null!==(n=p["Primary Cancer Condition Value"][0])&&void 0!==n?n:void 0,Laterality:null!==(a=p["Primary Cancer Condition Body Location Value"][0])&&void 0!==a?a:void 0,"Tumor Category":null!==(i=p["TNM Clinical Primary Tumor Category Data Value (T Category)"][0])&&void 0!==i?i:void 0,"Node Category":null!==(r=p["TNM Clinical Regional Nodes Category Data Value (N Category)"][0])&&void 0!==r?r:void 0,"Metastases Category":null!==(o=p["TNM Clinical Distant Metastases Category Data Value (M Category)"][0])&&void 0!==o?o:void 0,"Estrogen Receptor":null!==(c=p["Estrogen Receptor Value"][0])&&void 0!==c?c:void 0,"Progesterone Receptor":null!==(s=p["Progesterone Receptor Value"][0])&&void 0!==s?s:void 0,"HER2 Receptor":null!==(l=p["HER2 Receptor Value"][0])&&void 0!==l?l:void 0};b(v)}))}),[]),te=Object(a.useMemo)((function(){return{patientRecords:p,setPatientRecords:K,evaluatePath:D,setEvaluatePath:T,mcodeRecords:y,setMcodeRecords:ee}}),[p,K,D,T,y,ee]);Object(a.useEffect)((function(){if(n){F(new Pn);var e=Ee.a.get("demoPatients")+n+".json";fetch(e).then((function(e){return e.json()})).then((function(e){var t=e.find((function(e){return"Patient"===e.resourceType}));K(e),ee(e),s(t)}))}else gn.a.oauth2.init({clientId:"Input client id you get when you register the app",scope:"launch/patient openid profile"}).then((function(e){var t,n;(function(e){return e.request("/metadata").then((function(t){if(t.rest[0].operation.find((function(e){return"OperationDefinition/Patient--everything"===(e.definition.reference||e.definition)})))return function(e){return e.request("/Patient/".concat(e.patient.id,"/$everything"),{flat:!0,pageLimit:0}).then((function(e){return e}))}(e).then((function(e){return Ce(e)}));console.log("Cannot use $everything, using reverse includes instead");var n=[],a=[];return t.rest[0].resource.forEach((function(e){if("Patient"===e.type)e.searchRevInclude&&(a=e.searchRevInclude);else if(e.searchInclude){var t=e.searchInclude.filter((function(t){return t==="".concat(e.type,":patient")||t==="".concat(e.type,":subject")}));t.length>0&&n.push(t[0])}else if(e.searchParam){var i=e.searchParams.filter((function(e){return"patient"===e.name||"subject"===e.name}));i.length>0&&n.push("".concat(e.type,":").concat(i[0].name))}})),a.length>0?Ne(e,a,Oe).then((function(e){return Ce(e)})):n.length>0?Ne(e,n,Oe).then((function(e){return Ce(e)})):(console.log("Cannot use reverse includes, retrieving all resources manually from predefined list"),Oe(e,ge).then((function(e){return Ce(e)})))}))})(e).then((function(e){var t=["id","meta","resourceType"];e=e.filter((function(e){return!Object.keys(e).every((function(e){return t.includes(e)}))})),K(e),ee(e)})),null===(t=e.patient)||void 0===t||null===(n=t.read)||void 0===n||n.call(t).then((function(e){return s(e)})),F(e)}))}),[n,K,ee]),Object(a.useEffect)((function(){var e;null===z||void 0===z||null===(e=z.user)||void 0===e||e.read().then((function(e){var t=e.name&&$(e.name);t&&J(t)}))}),[z]);var ne=yn(Ee.a.get(n?"demoPathwaysService":"pathwaysService"));function ae(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];window.scrollTo(0,0),k(t),_(e)}Object(a.useEffect)((function(){"loaded"===ne.status&&0===q.length&&L(ne.payload.map((function(e){return{pathway:e,pathwayResults:null}})))}),[ne,q.length,z,p]),Object(a.useEffect)((function(){(null===Y||void 0===Y?void 0:Y.current)&&(null===Q||void 0===Q?void 0:Q.current)&&(Y.current.style.height=window.innerHeight-Q.current.clientHeight+"px")}),[O]);var ie=Object(a.useCallback)((function(e){for(var t=Object(l.a)(q),n=0;n<q.length;n++)q[n].pathway.name===e.pathway.name&&(t[n]=e,L(t));(null===E||void 0===E?void 0:E.pathway.name)===e.pathway.name&&_(e)}),[E,q]),re=Object(a.useCallback)((function(e){var t;if(c){var n=function(e,t){return{title:e,resourceType:"CarePlan",id:Z.a.generate(),text:{status:X.R4.NarrativeStatusKind._generated,div:"<div> Assignment of patient to pathway ".concat(e," </div>")},status:"active",intent:"plan",category:[{coding:[{system:"http://hl7.org/fhir/us/core/CodeSystem/careplan-category",code:"assess-plan"}]}],subject:{reference:"Patient/".concat(t.id)}}}(e,c);K([].concat(Object(l.a)(p),[n])),null===z||void 0===z||null===(t=z.create)||void 0===t||t.call(z,n)}}),[p,c,z,K]),oe=Object(a.useCallback)((function(e){var t=[];p.forEach((function(n){var a;"CarePlan"===n.resourceType&&n.title===e?null===z||void 0===z||null===(a=z.delete)||void 0===a||a.call(z,"CarePlan/".concat(n.id)):t.push(n)})),K(t)}),[p,K,z]);return i.a.createElement(P,null,i.a.createElement(xe,{client:z},i.a.createElement(G,{value:{user:W,setUser:J}},i.a.createElement(S,{value:{patient:c,setPatient:s}},i.a.createElement(le,{value:te},i.a.createElement(U,{pathwayCtx:{updateEvaluatedPathways:ie,evaluatedPathway:E,setEvaluatedPathway:ae,assignPathway:re,unassignPathway:oe}},i.a.createElement("div",{ref:Q},i.a.createElement(N,{logo:be.a}),i.a.createElement(he,{evaluatedPathways:q,selectPathway:O,setSelectPathway:k})),O?i.a.createElement(hn,{evaluatedPathways:q,callback:ae,service:ne,headerElement:Q}):i.a.createElement(Nn,{key:null!==(t=null===E||void 0===E?void 0:E.pathway.name)&&void 0!==t?t:"",headerElement:Q,graphContainerElement:Y})))))))},xn=document.getElementById("root");o.a.render(i.a.createElement(c.a,null,i.a.createElement(s.c,null,i.a.createElement(s.a,{exact:!0,path:"/",render:function(){return i.a.createElement(kn,null)}}),i.a.createElement(s.a,{path:"/demo/:id",render:function(e){return i.a.createElement(kn,{demoId:e.match.params.id,key:e.match.params.id})}}),i.a.createElement(s.a,{path:"/demo",render:function(){return i.a.createElement(kn,{demoId:"Maureen"})}}))),xn)},212:function(e,t,n){e.exports={patientSnapshot:"PatientSnapshot_patientSnapshot__3bGcm",patientSnapshot__info:"PatientSnapshot_patientSnapshot__info__2Ry7e",patientName:"PatientSnapshot_patientName__ZClJB",patientSnapshot__photo:"PatientSnapshot_patientSnapshot__photo__3XI7U",patientSnapshot__list:"PatientSnapshot_patientSnapshot__list__5DVC3"}},241:function(e,t,n){e.exports={navigation:"Navigation_navigation__1EgxP",navigation__back:"Navigation_navigation__back__2cVZ2",navigation__leftPanel:"Navigation_navigation__leftPanel__QjHPF",navigation__rightPanel:"Navigation_navigation__rightPanel__1FRD3"}},243:function(e,t,n){e.exports={reportModal:"ReportModal_reportModal__2hppG",sectionContainer:"ReportModal_sectionContainer__1iIQM",confirmationSection:"ReportModal_confirmationSection__2HXo4",confirmationButtonGroup:"ReportModal_confirmationButtonGroup__1FN9I"}},305:function(e,t,n){e.exports={arrow:"Arrow_arrow__3TM91",arrowhead:"Arrow_arrowhead__3XjQ0",arrowOnPatientPath:"Arrow_arrowOnPatientPath__1r5CB"}},364:function(e,t,n){var a={"./alert":365,"./alert.js":365,"./alert.js.map":1571,"./allergyintolerance":366,"./allergyintolerance.js":366,"./allergyintolerance.js.map":1572,"./appointment":367,"./appointment.js":367,"./appointment.js.map":1573,"./appointmentresponse":368,"./appointmentresponse.js":368,"./appointmentresponse.js.map":1574,"./availability":369,"./availability.js":369,"./availability.js.map":1575,"./basic":370,"./basic.js":370,"./basic.js.map":1576,"./binary":371,"./binary.js":371,"./binary.js.map":1577,"./bundle":372,"./bundle.js":372,"./bundle.js.map":1578,"./careplan":373,"./careplan.js":373,"./careplan.js.map":1579,"./claimresponse":374,"./claimresponse.js":374,"./claimresponse.js.map":1580,"./communicationrequest":375,"./communicationrequest.js":375,"./communicationrequest.js.map":1581,"./composition":376,"./composition.js":376,"./composition.js.map":1582,"./conceptmap":377,"./conceptmap.js":377,"./conceptmap.js.map":1583,"./condition":378,"./condition.js":378,"./condition.js.map":1584,"./conformance":379,"./conformance.js":379,"./conformance.js.map":1585,"./contract":380,"./contract.js":380,"./contract.js.map":1586,"./contraindication":381,"./contraindication.js":381,"./contraindication.js.map":1587,"./core":21,"./core.js":21,"./core.js.map":1588,"./coverage":382,"./coverage.js":382,"./coverage.js.map":1589,"./dataelement":383,"./dataelement.js":383,"./dataelement.js.map":1590,"./device":384,"./device.js":384,"./device.js.map":1591,"./devicecomponent":385,"./devicecomponent.js":385,"./devicecomponent.js.map":1592,"./deviceuserequest":386,"./deviceuserequest.js":386,"./deviceuserequest.js.map":1593,"./deviceusestatement":387,"./deviceusestatement.js":387,"./deviceusestatement.js.map":1594,"./diagnosticorder":388,"./diagnosticorder.js":388,"./diagnosticorder.js.map":1595,"./diagnosticreport":389,"./diagnosticreport.js":389,"./diagnosticreport.js.map":1596,"./documentmanifest":390,"./documentmanifest.js":390,"./documentmanifest.js.map":1597,"./documentreference":391,"./documentreference.js":391,"./documentreference.js.map":1598,"./eligibility":392,"./eligibility.js":392,"./eligibility.js.map":1599,"./eligibilityresponse":393,"./eligibilityresponse.js":393,"./eligibilityresponse.js.map":1600,"./encounter":394,"./encounter.js":394,"./encounter.js.map":1601,"./enrollment":395,"./enrollment.js":395,"./enrollment.js.map":1602,"./enrollmentresponse":396,"./enrollmentresponse.js":396,"./enrollmentresponse.js.map":1603,"./explanationofbenefit":397,"./explanationofbenefit.js":397,"./explanationofbenefit.js.map":1604,"./extensiondefinition":398,"./extensiondefinition.js":398,"./extensiondefinition.js.map":1605,"./familyhistory":399,"./familyhistory.js":399,"./familyhistory.js.map":1606,"./group":400,"./group.js":400,"./group.js.map":1607,"./healthcareservice":401,"./healthcareservice.js":401,"./healthcareservice.js.map":1608,"./imagingobjectselection":402,"./imagingobjectselection.js":402,"./imagingobjectselection.js.map":1609,"./imagingstudy":403,"./imagingstudy.js":403,"./imagingstudy.js.map":1610,"./immunization":404,"./immunization.js":404,"./immunization.js.map":1611,"./immunizationrecommendation":405,"./immunizationrecommendation.js":405,"./immunizationrecommendation.js.map":1612,"./list":406,"./list.js":406,"./list.js.map":1613,"./location":407,"./location.js":407,"./location.js.map":1614,"./media":408,"./media.js":408,"./media.js.map":1615,"./medication":409,"./medication.js":409,"./medication.js.map":1616,"./medicationadministration":410,"./medicationadministration.js":410,"./medicationadministration.js.map":1617,"./medicationdispense":411,"./medicationdispense.js":411,"./medicationdispense.js.map":1618,"./medicationprescription":412,"./medicationprescription.js":412,"./medicationprescription.js.map":1619,"./medicationstatement":413,"./medicationstatement.js":413,"./medicationstatement.js.map":1620,"./messageheader":414,"./messageheader.js":414,"./messageheader.js.map":1621,"./models":363,"./models.js":363,"./models.js.map":1622,"./namingsystem":415,"./namingsystem.js":415,"./namingsystem.js.map":1623,"./nutritionorder":416,"./nutritionorder.js":416,"./nutritionorder.js.map":1624,"./observation":417,"./observation.js":417,"./observation.js.map":1625,"./operationdefinition":418,"./operationdefinition.js":418,"./operationdefinition.js.map":1626,"./operationoutcome":419,"./operationoutcome.js":419,"./operationoutcome.js.map":1627,"./oralhealthclaim":420,"./oralhealthclaim.js":420,"./oralhealthclaim.js.map":1628,"./order":421,"./order.js":421,"./order.js.map":1629,"./orderresponse":422,"./orderresponse.js":422,"./orderresponse.js.map":1630,"./organization":423,"./organization.js":423,"./organization.js.map":1631,"./other":424,"./other.js":424,"./other.js.map":1632,"./patient":425,"./patient.js":425,"./patient.js.map":1633,"./paymentnotice":426,"./paymentnotice.js":426,"./paymentnotice.js.map":1634,"./paymentreconciliation":427,"./paymentreconciliation.js":427,"./paymentreconciliation.js.map":1635,"./pendedrequest":428,"./pendedrequest.js":428,"./pendedrequest.js.map":1636,"./practitioner":429,"./practitioner.js":429,"./practitioner.js.map":1637,"./procedure":430,"./procedure.js":430,"./procedure.js.map":1638,"./procedurerequest":431,"./procedurerequest.js":431,"./procedurerequest.js.map":1639,"./profile":432,"./profile.js":432,"./profile.js.map":1640,"./provenance":433,"./provenance.js":433,"./provenance.js.map":1641,"./query":434,"./query.js":434,"./query.js.map":1642,"./questionnaire":435,"./questionnaire.js":435,"./questionnaire.js.map":1643,"./questionnaireanswers":436,"./questionnaireanswers.js":436,"./questionnaireanswers.js.map":1644,"./readjudicate":437,"./readjudicate.js":437,"./readjudicate.js.map":1645,"./referralrequest":438,"./referralrequest.js":438,"./referralrequest.js.map":1646,"./relatedperson":439,"./relatedperson.js":439,"./relatedperson.js.map":1647,"./reversal":440,"./reversal.js":440,"./reversal.js.map":1648,"./riskassessment":441,"./riskassessment.js":441,"./riskassessment.js.map":1649,"./searchparameter":442,"./searchparameter.js":442,"./searchparameter.js.map":1650,"./securityevent":443,"./securityevent.js":443,"./securityevent.js.map":1651,"./slot":444,"./slot.js":444,"./slot.js.map":1652,"./specimen":445,"./specimen.js":445,"./specimen.js.map":1653,"./statusrequest":446,"./statusrequest.js":446,"./statusrequest.js.map":1654,"./statusresponse":447,"./statusresponse.js":447,"./statusresponse.js.map":1655,"./subscription":448,"./subscription.js":448,"./subscription.js.map":1656,"./substance":449,"./substance.js":449,"./substance.js.map":1657,"./supply":450,"./supply.js":450,"./supply.js.map":1658,"./supportingdocumentation":451,"./supportingdocumentation.js":451,"./supportingdocumentation.js.map":1659,"./valueset":452,"./valueset.js":452,"./valueset.js.map":1660};function i(e){var t=r(e);return n(t)}function r(e){if(!n.o(a,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return a[e]}i.keys=function(){return Object.keys(a)},i.resolve=r,e.exports=i,i.id=364},511:function(e,t,n){e.exports={dropdown:"DropDown_dropdown__1KvCw",check:"DropDown_check__2pubh"}},517:function(e,t,n){e.exports={display:"App_display__2vneK",graph:"App_graph__3EP_l"}},76:function(e,t,n){e.exports={pathways_list:"PathwaysList_pathways_list__2WO5g",header_title:"PathwaysList_header_title__7EM8s",header_title__header:"PathwaysList_header_title__header__36yqh",header_title__note:"PathwaysList_header_title__note__34zC8",container:"PathwaysList_container__1SC5K",assignedPathwayElement:"PathwaysList_assignedPathwayElement__2xpdU",title:"PathwaysList_title__ccVmw",numElements:"PathwaysList_numElements__1WAOk",expand:"PathwaysList_expand__2v9Wx",infoContainer:"PathwaysList_infoContainer__2q0Tn",details:"PathwaysList_details__2kSzT",pathway:"PathwaysList_pathway__1vqM1",matchingElement:"PathwaysList_matchingElement__1SQoM",controls:"PathwaysList_controls__vZmz8",pathwayElement:"PathwaysList_pathwayElement__34hJh",matchedElementsLabel:"PathwaysList_matchedElementsLabel__3cXeX",pathwayListHeaderContainer:"PathwaysList_pathwayListHeaderContainer__2l2fi"}}},[[1306,1,2]]]);
//# sourceMappingURL=main.63e90c4b.chunk.js.map