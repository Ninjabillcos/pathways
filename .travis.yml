---
language: node_js

node_js:
  - "12"

cache: yarn

script:
  - yarn lint
  - yarn test
  - yarn build
  # replace the pathways service in the config file with the gh static location
  # -i means in-place
  # see https://stackoverflow.com/a/11245501
  # note also multiline string here to get around some yaml weirdness
  - >
      sed -i "/pathwaysService:/c\  pathwaysService: 'https://mcode.github.io/pathways/static/pathways/'," build/config.js

deploy:
  provider: pages
  local_dir: build
  skip_cleanup: true
  github_token: $GITHUB_TOKEN  # Set in the settings page of your repository, as a secure variable
  keep_history: true
  on:
    branch: master
